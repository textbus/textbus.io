<script lang="ts"></script>
<template>
  <h1>安装</h1><p>通过 npm 安装 TextBus：</p><pre lang="null" theme="dark"><div class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><code>npm install @textbus/textbus</code></div></div></pre><p>在 html 中准备一个空的元素</p><pre lang="HTML" theme="dark"><div class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><code>&lt;<span class="tb-hl-tag">body</span>&gt;</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&lt;<span class="tb-hl-tag">div&nbsp;</span><span class="tb-hl-attr-name">id</span>="<span class="tb-hl-attr-value">editor</span>"&gt;&lt;/<span class="tb-hl-tag">div</span>&gt;</code></div><div class="tb-code-line"><code>&lt;/<span class="tb-hl-tag">body</span>&gt;</code></div></div><div class="tb-pre-lang">HTML</div></pre><p>通过 css 选择器，或直接传入一个 DOM 元素初始化 TextBus。</p><pre lang="Typescript" theme="dark"><div class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><code><span class="tb-hl-keyword">import</span>&nbsp;{ createEditor }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/textbus'</span>;</code></div><div class="tb-code-line"><code><br></code></div><div class="tb-code-line"><code><span class="tb-hl-keyword">import</span>&nbsp;<span class="tb-hl-string">'@textbus/textbus/bundles/textbus.min.css'</span>;</code></div><div class="tb-code-line"><code><br></code></div><div class="tb-code-line"><code><span class="tb-hl-keyword">const</span>&nbsp;editor =&nbsp;<span class="tb-hl-function">createEditor</span>(<span class="tb-hl-string">'#editor'</span>, {</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;<span class="tb-hl-comment">// theme: // 可选 'dark' | 'mac-os' | 'mac-os-dark'，不传即为默认样式</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;<span class="tb-hl-function">uploader</span>(uploadType， prevValue) {</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// switch (uploadType) {</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// &nbsp;&nbsp;case 'video':</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// &nbsp;&nbsp;&nbsp;&nbsp;console.log('上传视频');</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// &nbsp;&nbsp;&nbsp;&nbsp;break;</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// &nbsp;&nbsp;case 'image':</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// &nbsp;&nbsp;&nbsp;&nbsp;console.log('上传视频');</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// &nbsp;&nbsp;&nbsp;&nbsp;break;</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// &nbsp;&nbsp;case 'audio':</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// &nbsp;&nbsp;&nbsp;&nbsp;console.log('上传音频');</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// &nbsp;&nbsp;&nbsp;&nbsp;break;</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// }</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;<span class="tb-hl-builtin">Promise</span>.<span class="tb-hl-function">resolve</span>().<span class="tb-hl-function">then</span>(() =&gt; {</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;<span class="tb-hl-string">'/test'</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;})</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;},</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;contents:&nbsp;<span class="tb-hl-string">`&lt;p&gt;欢迎你使用&amp;nbsp;&lt;strong&gt;TextBus&lt;/strong&gt; 富文本编辑器...&lt;br&gt;&lt;/p&gt;`</span></code></div><div class="tb-code-line"><code>});</code></div><div class="tb-code-line"><code><br></code></div><div class="tb-code-line"><code>editor.onChange.<span class="tb-hl-function">subscribe</span>(() =&gt; {</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;<span class="tb-hl-builtin">console</span>.<span class="tb-hl-function">log</span>(editor.<span class="tb-hl-function">getContents</span>());</code></div><div class="tb-code-line"><code>});</code></div></div><div class="tb-pre-lang">Typescript</div></pre><p><br></p><h2>通过标签引入 TextBus</h2><p>你也可以直接下载 TextBus 的 js 文件和 css 文件，然后引用到你的页面中：</p><p>点击下载&nbsp;<a target="_blank" href="https:&#x2F;&#x2F;textbus.tanboui.com&#x2F;static&#x2F;textbus.min.js">textbus.min.js</a>&nbsp;&nbsp;&nbsp;<a target="_blank" href="https:&#x2F;&#x2F;textbus.tanboui.com&#x2F;static&#x2F;textbus.min.css">textbus.min.css</a></p><pre lang="HTML" theme="dark"><div class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><code>&lt;!DOCTYPE html&gt;</code></div><div class="tb-code-line"><code>&lt;<span class="tb-hl-tag">html&nbsp;</span><span class="tb-hl-attr-name">lang</span>="<span class="tb-hl-attr-value">en</span>"&gt;</code></div><div class="tb-code-line"><code>&lt;<span class="tb-hl-tag">head</span>&gt;</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&lt;<span class="tb-hl-tag">meta&nbsp;</span><span class="tb-hl-attr-name">charset</span>="<span class="tb-hl-attr-value">UTF-8</span>"&gt;</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&lt;<span class="tb-hl-tag">title</span>&gt;TextBus 示例&lt;/<span class="tb-hl-tag">title</span>&gt;</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&lt;<span class="tb-hl-tag">link&nbsp;</span><span class="tb-hl-attr-name">href</span>="<span class="tb-hl-attr-value">https://textbus.tanboui.com/static/textbus.min.css</span>"<span class="tb-hl-tag">&nbsp;</span><span class="tb-hl-attr-name">rel</span>="<span class="tb-hl-attr-value">stylesheet</span>"&gt;</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&lt;<span class="tb-hl-tag">script&nbsp;</span><span class="tb-hl-attr-name">src</span>="<span class="tb-hl-attr-value">https://textbus.tanboui.com/static/textbus.min.js</span>"&gt;&lt;/<span class="tb-hl-tag">script</span>&gt;</code></div><div class="tb-code-line"><code>&lt;/<span class="tb-hl-tag">head</span>&gt;</code></div><div class="tb-code-line"><code>&lt;<span class="tb-hl-tag">body</span>&gt;</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&lt;<span class="tb-hl-tag">div&nbsp;</span><span class="tb-hl-attr-name">id</span>="<span class="tb-hl-attr-value">editor</span>"&gt;&lt;/<span class="tb-hl-tag">div</span>&gt;</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&lt;<span class="tb-hl-tag">script</span>&gt;</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var editor = textbus.createEditor(document.getElementById('editor'));</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;editor.onChange.subscribe(function() {</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(editor.getContents());</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&lt;/<span class="tb-hl-tag">script</span>&gt;</code></div><div class="tb-code-line"><code>&lt;/<span class="tb-hl-tag">body</span>&gt;</code></div><div class="tb-code-line"><code>&lt;/<span class="tb-hl-tag">html</span>&gt;</code></div></div><div class="tb-pre-lang">HTML</div></pre><p><br></p><h2>配置项说明</h2><p>TextBus 官方库开发了非常丰富的工具和组件，且不仅限于官网的示例，你可以查看 TextBus 的 github 仓库，找到工具类、组件或格式的文件夹查看，你可以挑选自己需要的功能手动添加。如果你在官方库找不到你想要的功能，你当然也可以查看相关文档，编写自己的扩展。</p><p>当然，如果你想要一个更轻量的富文本编辑器，TextBus 所有的非核心功能都是可选的，在通过 createEditor 函数创建 TextBus 实例时，默认配置了一些工具、组件和格式类，你可以根据自己的需要删除一些功能。下面我们把创建编辑器时的可选项作一些说明。</p><tb-word-explain><div style="width:140px" class="tb-word-explain-title-group"><div style="text-align:right" class="tb-word-explain-title"><strong>theme</strong></div><div style="text-align:right" class="tb-word-explain-subtitle">主题</div></div><div class="tb-word-explain-detail">TextBus 默认提供了 4 种主题，不配置即为默认，你可以根据自己的喜好配置另外三种：dark、mac-os、mac-os-dark。<br></div></tb-word-explain><tb-word-explain><div style="width:140px" class="tb-word-explain-title-group"><div style="text-align:right" class="tb-word-explain-title"><strong>historyStackSize</strong></div><div style="text-align:right" class="tb-word-explain-subtitle">历史记录最大次数</div></div><div class="tb-word-explain-detail">默认为 50，你可以根据自己的需要配置。当然，为了防止过多占用内存，不建议设置过大。<br>TextBus 的历史记录为内存数据，也就意味着，当浏览器刷新了，数据就丢失了。为了防止此类事件，建议在使用过程中，本地用 localStorage 实时保存数据。</div></tb-word-explain><tb-word-explain><div style="width:140px" class="tb-word-explain-title-group"><div style="text-align:right" class="tb-word-explain-title"><strong>components</strong></div><div style="text-align:right" class="tb-word-explain-subtitle">组件集合</div></div><div class="tb-word-explain-detail">TextBus 的组件，你可以根据自己的需要配置组件，也可以把自己开发的组件添加进来。<br><span style="font-size:14px"><strong style="color:rgb(231, 79, 94)">注意：</strong>这里配置的组件是组件类本身，而不是实例。组件开发的相关文档，你可以点击左侧导航查看。</span></div></tb-word-explain><tb-word-explain><div style="width:140px" class="tb-word-explain-title-group"><div style="text-align:right" class="tb-word-explain-title"><strong>formatters</strong></div><div style="text-align:right" class="tb-word-explain-subtitle">格式集合</div></div><div class="tb-word-explain-detail">用于支持格式的 Formatter 实例。格式特指如：加粗、斜体、字体颜色等这一类装饰性功能。</div></tb-word-explain><tb-word-explain><div style="width:140px" class="tb-word-explain-title-group"><div style="text-align:right" class="tb-word-explain-title"><strong>styleSheets</strong></div><div style="text-align:right" class="tb-word-explain-subtitle">文档默认样式</div></div><div class="tb-word-explain-detail">为了让文档编辑和最终显示时有统一的样式，你可以把自己的样式表配置在这里，TextBus 会在创建编辑器时插入在文档中<span style="color:rgb(73, 80, 96);font-size:14px">（由于 TextBus 的编辑界面是在 iframe 里面，所以这里的样式不会影响当前页面）</span>。同时，会在输出内容时输出到结果中。</div></tb-word-explain><tb-word-explain><div style="width:140px" class="tb-word-explain-title-group"><div style="text-align:right" class="tb-word-explain-title"><strong>editingStyleSheets</strong></div><div style="text-align:right" class="tb-word-explain-subtitle">编辑时样式</div></div><div class="tb-word-explain-detail">在某些情况下，编辑时我们需要一些额外的样式去定制编辑时的 UI 界面或交互。你可以把这些特定的样式配置在这里，TextBus 会在创建编辑器时插入在文档中<span style="color:rgb(73, 80, 96);font-size:14px">（由于 TextBus 的编辑界面是在 iframe 里面，所以这里的样式不会影响当前页面）</span>。但在输出时不会作为文档的一部分。</div></tb-word-explain><tb-word-explain><div style="width:140px" class="tb-word-explain-title-group"><div style="text-align:right" class="tb-word-explain-title"><strong>contents</strong></div><div style="text-align:right" class="tb-word-explain-subtitle">默认内容</div></div><div class="tb-word-explain-detail">初始化编辑器时，默认的内容。</div></tb-word-explain><tb-word-explain><div style="width:140px" class="tb-word-explain-title-group"><div style="text-align:right" class="tb-word-explain-title"><strong>providers</strong></div><div style="text-align:right" class="tb-word-explain-subtitle">提供者集合</div></div><div class="tb-word-explain-detail">TextBus 整体架构是遵循的依赖注入设计模式。此配置项主要是为一些插件提供自定义注入参数的配置。配置的数据，因插件的不同而不同，你可以参考具体插件的说明。</div></tb-word-explain><tb-word-explain><div style="width:140px" class="tb-word-explain-title-group"><div style="text-align:right" class="tb-word-explain-title"><strong>plugins</strong></div><div style="text-align:right" class="tb-word-explain-subtitle">插件集合</div></div><div class="tb-word-explain-detail">和其它富文本编辑器不同，在 TextBus 中，插件只是作为一种增强手段。一般来说，如果要扩展功能，我们都是围绕组件和格式展开的。TextBus 官方提供了一些默认的插件，你可以根据你自己的需要添加或删除。</div></tb-word-explain><tb-word-explain><div style="width:140px" class="tb-word-explain-title-group"><div style="text-align:right" class="tb-word-explain-title"><strong>i18n</strong></div><div style="text-align:right" class="tb-word-explain-subtitle">国际化</div></div><div class="tb-word-explain-detail">国际化配置，TextBus 默认语言为中文，同时，还提供了英语语言包。你可以导入相关配置替换默认的语言设置。如果你还需要其它语言，你可以从官方仓库复制出一份配置文件，并把对应值替换成你想要的语言，再添加在配置项中即可。</div></tb-word-explain><tb-word-explain><div style="width:140px" class="tb-word-explain-title-group"><div style="text-align:right" class="tb-word-explain-title"><strong>uploader</strong></div><div style="text-align:right" class="tb-word-explain-subtitle">上传文件接口</div></div><div class="tb-word-explain-detail">TextBus 统一的上传文件接口，所有涉及到上传文件的功能，都会调用此函数。你可以根据参数类型，实现对应的文件上传并通过 Promise 或 Observale 返回对应资源的 url。<br>如果你已开发有自己的资源管理功能，你也可以在这里触发文件选择，并把用户选中文件的 url 地址返回给 TextBus 即可。<br></div></tb-word-explain><tb-word-explain><div style="width:140px" class="tb-word-explain-title-group"><div style="text-align:right" class="tb-word-explain-title"><strong>onSave</strong></div><div style="text-align:right" class="tb-word-explain-subtitle">用户保存接口</div></div><div class="tb-word-explain-detail">当用户按 ctrl + s 时的回调，你可以在回调中把内容实时保存到服务器。</div></tb-word-explain><p><br></p><h2>常用方法</h2><p>当创建完成编辑器后，你可以通过编辑器实例访问以下接口属性。</p><tb-timeline><div class="tb-timeline-item tb-timeline-item-primary"><div class="tb-timeline-line"></div><div class="tb-timeline-icon"></div><div class="tb-timeline-content"><div><strong style="font-size:18px">onReady&nbsp;</strong><span style="font-size:15px;color:rgb(119, 119, 119)">类型：Observable&lt;void&gt;</span></div><p>编辑器初始化状态可订阅对象，部分方法需要初始化后才可以调用。</p><pre lang="Typescript" theme="dark"><div class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><code>editor.onReady.<span class="tb-hl-function">subscribe</span>(() =&gt; {</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;<span class="tb-hl-comment">// your code...</span></code></div><div class="tb-code-line"><code>})</code></div></div><div class="tb-pre-lang">Typescript</div></pre></div></div><div class="tb-timeline-item tb-timeline-item-primary"><div class="tb-timeline-line"></div><div class="tb-timeline-icon"></div><div class="tb-timeline-content"><div><strong style="font-size:18px">onChange&nbsp;</strong><span style="font-size:15px;color:rgb(119, 119, 119)">类型：Observable&lt;void&gt;</span></div><p style="color:rgb(0, 0, 0);font-size:medium">编辑器内容变更事件订阅对象。</p><pre lang="Typescript" theme="dark"><div class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><code>editor.onChange.<span class="tb-hl-function">subscribe</span>(() =&gt; {</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;<span class="tb-hl-comment">// your code...</span></code></div><div class="tb-code-line"><code>})</code></div></div><div class="tb-pre-lang">Typescript</div></pre></div></div><div class="tb-timeline-item tb-timeline-item-primary"><div class="tb-timeline-line"></div><div class="tb-timeline-icon"></div><div class="tb-timeline-content"><div><strong style="font-size:18px">stateController&nbsp;</strong><span style="font-size:15px;color:rgb(119, 119, 119)">类型：EditorController</span></div><p><span style="color:rgb(0, 0, 0);font-size:medium">编辑器状态控制类，可通过此实例设置或监听编辑器公共状态。</span><br></p></div></div><div class="tb-timeline-item tb-timeline-item-primary"><div class="tb-timeline-line"></div><div class="tb-timeline-icon"></div><div class="tb-timeline-content"><div><strong style="font-size:18px">readonly&nbsp;</strong><span style="font-size:15px;color:rgb(119, 119, 119)">类型：boolean</span></div><p><span style="color:rgb(0, 0, 0);font-size:medium">设置或读取编辑是否为只读状态。</span><br></p></div></div><div class="tb-timeline-item tb-timeline-item-primary"><div class="tb-timeline-line"></div><div class="tb-timeline-icon"></div><div class="tb-timeline-content"><div><strong style="font-size:18px">injector&nbsp;</strong><span style="font-size:15px;color:rgb(119, 119, 119)">类型：Injector</span></div><p>TextBus 实例注入器，需 ready 完成后才存在，通过 injector 可以获取到所有的内部核心类实例。</p></div></div><div class="tb-timeline-item tb-timeline-item-primary"><div class="tb-timeline-line"></div><div class="tb-timeline-icon"></div><div class="tb-timeline-content"><div><strong style="font-size:18px">setContents(html)&nbsp;</strong><span style="font-size:15px;color:rgb(119, 119, 119)">类型：(html: string) =&gt; Promise&lt;void&gt;</span></div><p>设置编辑器内容。</p></div></div><div class="tb-timeline-item tb-timeline-item-primary"><div class="tb-timeline-line"></div><div class="tb-timeline-icon"></div><div class="tb-timeline-content"><div><strong style="font-size:18px">getContents()&nbsp;</strong><span style="font-size:15px;color:rgb(119, 119, 119)">类型：() =&gt; OutputContent&lt;string&gt;</span></div><p>获取编辑器内容，包含：</p><ul><li>content：html 字符串；</li><li>styleSheets: 一个 css 样式表的数组；</li><li>links：一些依赖的外部资源配置，如数学公式组件依赖于第三方的样式表；</li><li>scripts: 一些组件依赖的脚本，通常为一些高级用户开发的组件的输出内容。一般情况下可忽略。</li></ul></div></div><div class="tb-timeline-item tb-timeline-item-primary"><div class="tb-timeline-line"></div><div class="tb-timeline-icon"></div><div class="tb-timeline-content"><div><strong style="font-size:18px">getJSONLiteral()&nbsp;</strong><span style="font-size:15px;color:rgb(119, 119, 119)">类型：() =&gt; OutputContent&lt;VElementLiteral&gt;</span></div><ul><li>content：一个描述内容的 JSON 对象；</li><li>styleSheets: 一个 css 样式表的数组；</li><li>links：一些依赖的外部资源配置，如数学公式组件依赖于第三方的样式表；</li><li>scripts: 一些组件依赖的脚本，通常为一些高级用户开发的组件的输出内容。一般情况下可忽略。</li></ul></div></div><div class="tb-timeline-item tb-timeline-item-primary"><div class="tb-timeline-line"></div><div class="tb-timeline-icon"></div><div class="tb-timeline-content"><div><strong style="font-size:18px">destroy&nbsp;</strong><span style="font-size:15px;color:rgb(119, 119, 119)">类型：() =&gt; void</span></div><p>销毁 TextBus 实例。</p></div></div></tb-timeline><h3>部分组件配置项</h3><p>代码块风格配置</p><pre lang="Typescript" theme="dark"><div class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><code><span class="tb-hl-keyword">import</span>&nbsp;{ PreComponeent }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/textbus'</span>;</code></div><div class="tb-code-line"><code><br></code></div><div class="tb-code-line"><code>PreComponeent.theme =&nbsp;<span class="tb-hl-string">'dark'</span>;&nbsp;<span class="tb-hl-comment">// 默认为 light</span></code></div></div><div class="tb-pre-lang">Typescript</div></pre><p>百度地图 ak，请参考百度地图开发者文档</p><pre lang="Typescript" theme="dark"><div class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><code><span class="tb-hl-keyword">import</span>&nbsp;{ BaiduMapComponent }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/textbus'</span>;</code></div><div class="tb-code-line"><code><br></code></div><div class="tb-code-line"><code>BaiduMapComponent.ak =&nbsp;<span class="tb-hl-string">'xxxx'</span>;&nbsp;<span class="tb-hl-comment">// 你自己的 ak</span></code></div></div><div class="tb-pre-lang">Typescript</div></pre><p><br></p><h1>配置项详解</h1><p>在首页的演示中，我们看到 TextBus 提供了非常丰富的功能，但你可能不需要这么多，下面的教程我们将一步一步的添加配置，来看看每一个配置项对 TextBus 的影响。</p><p>如果你需要更高级的扩展，你可能需要学习使用 TextBus 内部的 API 来完成你的功能，请阅读读开发者中心的相关文档！</p><div class="tb-alert"><strong style="color:rgb(18, 150, 219)">小知识：</strong>得益于现代前端构建工具，如 webpack，如果我们没有在配置项内添加相应的配置，webpack 在打包的时候将不会把对应的 es 模块打包进最终的结果中，这样我们将可以获得一个更轻量的应用。<br></div><p>我们先创建一个空白的编辑器：</p><pre lang="Typescript" theme="dark"><div class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><code><span class="tb-hl-keyword">import</span>&nbsp;{ Editor, EditorOptions }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/textbus'</span>;</code></div><div class="tb-code-line"><code><br></code></div><div class="tb-code-line"><code><span class="tb-hl-keyword">const</span>&nbsp;options: EditorOptions = {</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;contents:&nbsp;<span class="tb-hl-string">'&lt;p&gt;欢迎你使用 &lt;strong&gt;TextBus 富文本编辑器！&lt;/strong&gt;&lt;/p&gt;'</span></code></div><div class="tb-code-line"><code>};</code></div><div class="tb-code-line"><code><br></code></div><div class="tb-code-line"><code><span class="tb-hl-keyword">const</span>&nbsp;editor =&nbsp;<span class="tb-hl-keyword">new</span>&nbsp;<span class="tb-hl-class-name">Editor</span>(document.<span class="tb-hl-function">getElementById</span>(<span class="tb-hl-string">'editor'</span>), options);</code></div></div><div class="tb-pre-lang">Typescript</div></pre><p>现在，我们在浏览器中查看编辑器，会发现 TextBus 只有一个可编辑的框，同时也只有基本的文字编辑功能。从展现上，我们发现我们输入的 strong &nbsp;标签没有生效。</p><p style="text-align:center"><img src="https:&#x2F;&#x2F;textbus.tanboui.com&#x2F;07fc2af44f66a.png" style="width:606px;height:268px"></p><p>这时我们打开控制台审查元素，会发现 TextBus 并不会像我们预期的那样，在编辑区域展示我们设置的内容，而是把 p 和 strong 都弄丢了。</p><p style="text-align:center"><img src="https:&#x2F;&#x2F;textbus.tanboui.com&#x2F;09e4c3b6e44a38.png" style="width:503px;height:125px"></p><p>不用担心，这是正常的。因为在没有添加组件和格式支持的时候，TextBus 会不认识我们传入的内容。</p><div class="tb-alert"><strong style="color:rgb(18, 150, 219)">小知识：</strong>TextBus 并不会像传统编辑器一样，直接把内容放进编辑区域，而是会根据使用者的配置，去解析传入的内容。你可以理解为一个白名单机制。由此带来的好处是，我们的内容一定是符合预期的，并且天然的过滤了脏内容。这在从其它地方复制内容时（如 word），体现尤为明显。</div><p>下面我们把段落和加粗的功能添加到配置项中。<br><br></p><h2>配置组件和格式</h2><pre lang="Typescript" theme="dark"><div class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><code><span class="tb-hl-keyword">import</span>&nbsp;{ Editor, EditorOptions, BlockComponent, boldFormatter }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/textbus'</span>;</code></div><div class="tb-code-line"><code><br></code></div><div class="tb-code-line"><code><span class="tb-hl-keyword">const</span>&nbsp;options: EditorOptions = {</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;contents:&nbsp;<span class="tb-hl-string">'&lt;p&gt;欢迎你使用 &lt;strong&gt;TextBus 富文本编辑器！&lt;/strong&gt;&lt;/p&gt;'</span>,</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;components: [BlockComponent],</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;formatters: [boldFormatter]</code></div><div class="tb-code-line"><code>};</code></div><div class="tb-code-line"><code><br></code></div><div class="tb-code-line"><code><span class="tb-hl-keyword">const</span>&nbsp;editor =&nbsp;<span class="tb-hl-keyword">new</span>&nbsp;<span class="tb-hl-class-name">Editor</span>(document.<span class="tb-hl-function">getElementById</span>(<span class="tb-hl-string">'editor'</span>, options);</code></div></div><div class="tb-pre-lang">Typescript</div></pre><p>现在我们重新刷新浏览器，可以看到编辑器内的内容和我们传入的内容一致了。</p><p style="text-align:center"><img src="https:&#x2F;&#x2F;textbus.tanboui.com&#x2F;09a486f021a4a7.png" style="width:566px;height:248px"></p><p>我们再一次审查元素，可以看到，编辑器内的 DOM 结构也还原了。需要注意的事，其中，p 标签是一个组件，而 strong 则是指格式。</p><p style="text-align:center"><img src="https:&#x2F;&#x2F;textbus.tanboui.com&#x2F;026698d99c1a4d.png" style="width:473px;height:182px"></p><p>现在，我们把内置的所有组件和格式都添加进 TextBus 的配置项中。</p><div class="tb-alert"><strong style="color:rgb(231, 79, 94)">注意：</strong>为了节省篇幅，以下配置项均不显式的从 TextBus 中导入相关的类或成员。在实际的使用中，你需要手动导入。</div><pre lang="Typescript" theme="dark"><div class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><code><span class="tb-hl-keyword">const</span>&nbsp;options: EditorOptions = {</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;<span class="tb-hl-comment">// ... 其它配置</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;components: [</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;ListComponent,&nbsp;<span class="tb-hl-comment">// ul、ol 列表组件</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;BlockComponent,&nbsp;<span class="tb-hl-comment">// 支持 div,p,h1,h2,h3,h4,h5,h6,blockquote,article,section,nav,header,footer 的块级元素组件</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;PreComponent,&nbsp;<span class="tb-hl-comment">// 代码块组件</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;AudioComponent,&nbsp;<span class="tb-hl-comment">// 音频组件</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;VideoComponent,&nbsp;<span class="tb-hl-comment">// 视频组件</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;ImageComponent,&nbsp;<span class="tb-hl-comment">// 图片组件</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;TableComponent &nbsp;<span class="tb-hl-comment">// 表格组件</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;],</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;formatters: [</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;fontFamilyFormatter,&nbsp;<span class="tb-hl-comment">// 字体</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;boldFormatter,&nbsp;<span class="tb-hl-comment">// 加粗</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;linkFormatter,&nbsp;<span class="tb-hl-comment">// 超链接</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;backgroundColorFormatter,&nbsp;<span class="tb-hl-comment">// 文字背景颜色</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;blockBackgroundColorFormatter,&nbsp;<span class="tb-hl-comment">// 块背景颜色</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;codeFormatter,&nbsp;<span class="tb-hl-comment">// 行内代码</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;colorFormatter,&nbsp;<span class="tb-hl-comment">// 字体颜色</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;fontSizeFormatter,&nbsp;<span class="tb-hl-comment">// 字体大小</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;italicFormatter,&nbsp;<span class="tb-hl-comment">// 斜体</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;letterSpacingFormatter,&nbsp;<span class="tb-hl-comment">// 文字间距</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;lineHeightFormatter,&nbsp;<span class="tb-hl-comment">// 行高</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;strikeThroughFormatter,&nbsp;<span class="tb-hl-comment">// 中划线</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;subscriptFormatter,&nbsp;<span class="tb-hl-comment">// 上角标</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;superscriptFormatter,&nbsp;<span class="tb-hl-comment">// 下角标</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;textAlignFormatter,&nbsp;<span class="tb-hl-comment">// 文字对齐方式</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;textIndentFormatter,&nbsp;<span class="tb-hl-comment">// 首行缩进</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;underlineFormatter,&nbsp;<span class="tb-hl-comment">// 下划线</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;dirFormatter,&nbsp;<span class="tb-hl-comment">// 内容排版方向</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;tdBorderColorFormatter&nbsp;<span class="tb-hl-comment">// 表格边框颜色</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;]</code></div><div class="tb-code-line"><code>}</code></div></div><div class="tb-pre-lang">Typescript</div></pre><p>至此，我们的编辑器基本支持了大多数富文本的内容及格式了。但光有这些还不够，我们还需要一些工具可以用来动态创建组件或格式，这里就轮到我们的插件系统登场了。</p><div class="tb-alert"><strong style="color:rgb(18, 150, 219)">小提示：</strong>TextBus 官方还开发有更多的组件和格式，你可以查看 github 仓库。<br></div><p><br></p><h2>配置工具条</h2><p>在 TextBus 中，组件默认会带有一些编辑的交互行为，但更多的时候，是需要插件来协助，以帮助我们完成更复杂的操作。需要说明的是，所有的插件都不是必需的，你可以使用 TextBus 官方开的插件，也可以自己开发插件。</p><p>我们先来配置工具条。</p><pre lang="Typescript" theme="dark"><div class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><code><span class="tb-hl-keyword">const</span>&nbsp;options: EditorOptions = {</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;<span class="tb-hl-comment">// ... 其它配置</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;plugins: [</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;Toolbar</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;]</code></div><div class="tb-code-line"><code>}</code></div></div><div class="tb-pre-lang">Typescript</div></pre><p>我们在上面配置了工具条，现在刷新浏览器，查看效果：</p><p style="text-align:center"><img src="https:&#x2F;&#x2F;textbus.tanboui.com&#x2F;03201a4c727a4b.png" style="width:608px;height:270px"></p><p>我们发现编辑器有了变化，在顶部多了一个空白的工具栏，但还没有任何工具。这是因为我们只添加了工具条插件，还没有添加具体的工具配置。下面我们可以根据自己的需求，添加工具了。</p><pre lang="Typescript" theme="dark"><div class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><code><span class="tb-hl-keyword">const</span>&nbsp;options: EditorOptions = {</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;<span class="tb-hl-comment">// ... 其它配置</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;providers: [{</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;provide: TOOLS,</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;useValue: [</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[historyBackTool, historyForwardTool],</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[insertObjectTool],</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[headingTool],</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[boldTool, italicTool, strikeThroughTool, underlineTool],</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[olTool, ulTool],</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[fontSizeTool, textIndentTool],</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[colorTool, textBackgroundTool],</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[insertParagraphBeforeTool, insertParagraphAfterTool],</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[fontFamilyTool],</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[linkTool, unlinkTool],</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[imageTool],</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[textAlignTool],</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[tableTool],</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[findTool],</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[cleanTool]</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;]</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;}],</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;plugins: [</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;Toolbar</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;]</code></div><div class="tb-code-line"><code>}</code></div></div><div class="tb-pre-lang">Typescript</div></pre><p>添加工具后，编辑器效果如下：</p><p style="text-align:center"><img src="https:&#x2F;&#x2F;textbus.tanboui.com&#x2F;0ebd5a94188e1b.png" style="width:683px;height:300px"></p><p>当然，你也可以根据自己的需要，删除一部分工具。</p><div class="tb-alert"><strong style="color:rgb(18, 150, 219)">小提示：</strong>除了上面的工具，TextBus 官方的工具库还有更多的工具，你可以查看 github 仓库。</div><p>除了上面的工具，TextBus 官方还开发了一系列的插件，来增强编辑器的功能。</p><p><br></p><h2>配置其它插件</h2><p><strong>组件库插件</strong></p><p>TextBus 官方开发一系列的增强组件，这些组件可以为我们提供更强大的排版布局功能。</p><pre lang="Typescript" theme="dark"><div class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><code><span class="tb-hl-keyword">const</span>&nbsp;options: EditorOptions = {</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;<span class="tb-hl-comment">// ... 其它配置</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;components: [</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;AlertComponent,&nbsp;</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;KatexComponent,&nbsp;</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;StepComponent,&nbsp;</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;ProgressComponent,&nbsp;</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;TimelineComponent,&nbsp;</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;WordExplainComponent,&nbsp;</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;JumbotronComponent,&nbsp;</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;BaiduMapComponent,&nbsp;</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;TodoListComponent,&nbsp;</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;ImageCardComponent,</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;],</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;providers: [{</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;provide: COMPONENT_CREATORS,</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;useValue: [</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imageCardComponentExample,&nbsp;</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;todoListComponentExample,&nbsp;</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;baiduMapComponentExample,&nbsp;</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jumbotronComponentExample,&nbsp;</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wordExplainComponentExample,&nbsp;</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;katexComponentExample,&nbsp;</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;timelineComponentExample,&nbsp;</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stepsComponentExample,&nbsp;</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;progressComponentExample,&nbsp;</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alertComponentExample,</code></div><div class="tb-code-line"><code><br></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;]</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;}],</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;plugins: [</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;ComponentStagePlugin</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;]</code></div><div class="tb-code-line"><code>}</code></div></div><div class="tb-pre-lang">Typescript</div></pre><p>配置添加完毕后，TextBus 右侧会多一个展示组件的侧边栏。你可以点击任意一个组件，插件到文档中。</p><p style="text-align:center"><img src="https:&#x2F;&#x2F;textbus.tanboui.com&#x2F;0fc898687c072d.png" style="width:688px;height:497px"></p><p><strong>设备视图插件</strong></p><p>有时我们在编辑器内编辑的内容不仅仅在 PC 端展示，也会在移动端展示。为了我们能更直观的查看效果，我们可以添加一个设备切换的插件，帮助我们在编辑时就能准确的知道最终的显示结果。</p><pre lang="Typescript" theme="dark"><div class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><code><span class="tb-hl-keyword">const</span>&nbsp;options: EditorOptions = {</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;<span class="tb-hl-comment">// ... 其它配置</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;providers: [{</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;provide: DEVICE_OPTIONS,</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;useValue: [{</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label:&nbsp;<span class="tb-hl-string">'PC'</span>,</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value:&nbsp;<span class="tb-hl-string">'100%'</span>,</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">default</span>:&nbsp;<span class="tb-hl-boolean">true</span>,</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;}, {</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label:&nbsp;<span class="tb-hl-string">'iPhone5/SE'</span>,</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value:&nbsp;<span class="tb-hl-string">'320px'</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;}, {</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label:&nbsp;<span class="tb-hl-string">'iPhone6/7/8/X'</span>,</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value:&nbsp;<span class="tb-hl-string">'375px'</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;}, {</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label:&nbsp;<span class="tb-hl-string">'iPhone6/7/8 Plus'</span>,</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value:&nbsp;<span class="tb-hl-string">'414px'</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;}, {</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label:&nbsp;<span class="tb-hl-string">'iPad'</span>,</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value:&nbsp;<span class="tb-hl-string">'768px'</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;}, {</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label:&nbsp;<span class="tb-hl-string">'iPad Pro'</span>,</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value:&nbsp;<span class="tb-hl-string">'1024px'</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;}, {</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label:&nbsp;<span class="tb-hl-string">'A4'</span>,</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;value:&nbsp;<span class="tb-hl-string">'842px'</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;}]</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;}],</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;plugins: [</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;DevicePlugin</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;]</code></div><div class="tb-code-line"><code>}</code></div></div><div class="tb-pre-lang">Typescript</div></pre><p>除了上面的插件，我们还可以配置更多。</p><pre lang="Typescript" theme="dark"><div class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><code><span class="tb-hl-keyword">const</span>&nbsp;options: EditorOptions = {</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;<span class="tb-hl-comment">// ... 其它配置</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;plugins: [</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;Toolbar,&nbsp;<span class="tb-hl-comment">// 工具条插件</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;ComponentLibraryPlugin,&nbsp;<span class="tb-hl-comment">// 组件库展示插件</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;ContextmenuPlugin,&nbsp;<span class="tb-hl-comment">// 默认右键扩展菜单插件</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;PasteUploadEmitterPlugin,&nbsp;<span class="tb-hl-comment">// 粘贴触发上传弹窗插件</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;GuardEndBlockPlugin,&nbsp;<span class="tb-hl-comment">// 确保文档最后有可编辑段落插件（必备）</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;OutlinesPlugin,&nbsp;<span class="tb-hl-comment">// 文章大纲导航插件</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;FullScreenPlugin,&nbsp;<span class="tb-hl-comment">// 全屏插件</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;DeviceTogglePlugin,&nbsp;<span class="tb-hl-comment">// 设备切换插件</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;ImageAndVideoDragResizePlugin,&nbsp;<span class="tb-hl-comment">// 图片视频拖拽缩放插件</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;LinkJumpTipPlugin,&nbsp;<span class="tb-hl-comment">// 超链接点击弹出跳转 tip 插件</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;TableEditEnhancePlugin,&nbsp;<span class="tb-hl-comment">// 表格框选编辑支持插件</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;SourcecodeModePlugin,&nbsp;<span class="tb-hl-comment">// 源代码编辑模式插件&nbsp;</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;]</code></div><div class="tb-code-line"><code>}</code></div></div><div class="tb-pre-lang">Typescript</div></pre><p><br></p><h1>自定义布局</h1><p>默认情况下，编辑器是一个整体渲染到页面中的，如果你需要调整布局，你可以访问 Layout 类，并把其中的某些布局容器添加到自己的需要的地方。</p><pre lang="Typescript" theme="dark"><div class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><code>editor.onReady.<span class="tb-hl-function">subscribe</span>(() =&gt; {</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;customTopBar = document.<span class="tb-hl-function">getElementById</span>(<span class="tb-hl-string">'toolbar'</span>);</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;<span class="tb-hl-comment">// 获取 TextBus 布局类</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;layout = editor.injector.<span class="tb-hl-keyword">get</span>(Layout);</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;<span class="tb-hl-comment">// 把编辑器的顶部条添加到自定义的容器中</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;customTopbar.<span class="tb-hl-function">appendChild</span>(layout.topBar);</code></div><div class="tb-code-line"><code>})</code></div></div><div class="tb-pre-lang">Typescript</div></pre><p>除了顶部的条，Layout 类还有更多的容器（如：bottomBar，leftContainer，rightContainer 等)，你都可以访问，并把它们重新添加到指定位置。需要注意的是 ，如下这部分结构是不可以调整的，否则会引起其它工具尺寸计算问题。</p><p style="text-align:center"><img src="https:&#x2F;&#x2F;textbus.tanboui.com&#x2F;0831be2ee5ad71.png" style="width:544px;height:168px"></p><p><br></p><h1>预防 XSS 攻击</h1><p>xss 攻击是现在网络攻击的常见手段，富文本更是 xss 攻击的高发地带，理论上我们不应该相信任何的用户数据。为了数据安全，你应该需要了解 TextBus 对 xss 处理的一些特性。同时，针对你自己的特殊需求，酌情在此基础上做更进一步处理。</p><p>TextBus 的架构设计天然能过滤一些不识别的内容（根据你配置的组件和格式，你可以看成是一个白名单）。在输出时，TextBus 也会对一些可能产生 xss 攻击的地方对关键字符均做了转义处理（起始于版本 1.0.0-beta.51），为了防止有遗漏的地方，下面我们对一些已处理的数据作一些说明。</p><div class="tb-alert"><strong style="color:rgb(18, 150, 219)">提示：</strong>你可以查看&nbsp;<a target="_blank" href="https:&#x2F;&#x2F;github.com&#x2F;tbhuabi&#x2F;textbus&#x2F;blob&#x2F;master&#x2F;src&#x2F;lib&#x2F;output-translator.ts">HTMLOutputTranslator</a>&nbsp;，了解具体逻辑。<br></div><p><strong>文本处理：</strong></p><table class="tb-table"><tbody><tr><td style="background-color:#1c2838;text-indent:1em;border-color:rgb(73, 80, 96) rgb(73, 80, 96) rgb(221, 222, 225);border-left-color:rgb(73, 80, 96);border-top-color:rgb(73, 80, 96);border-right-color:rgb(73, 80, 96);border-bottom-color:rgb(221, 222, 225);color:rgb(233, 234, 236);line-height:1.6em">原字符</td><td style="background-color:#1c2838;text-indent:1em;border-color:rgb(73, 80, 96) rgb(73, 80, 96) rgb(221, 222, 225);border-left-color:rgb(73, 80, 96);border-top-color:rgb(73, 80, 96);border-right-color:rgb(73, 80, 96);border-bottom-color:rgb(221, 222, 225);color:rgb(233, 234, 236);line-height:1.6em">转义后</td><td style="background-color:#1c2838;text-indent:1em;border-color:rgb(73, 80, 96) rgb(73, 80, 96) rgb(221, 222, 225);border-left-color:rgb(73, 80, 96);border-top-color:rgb(73, 80, 96);border-right-color:rgb(73, 80, 96);border-bottom-color:rgb(221, 222, 225);color:rgb(233, 234, 236);line-height:1.6em">说明</td></tr><tr><td style="text-indent:1em;border-color:rgb(221, 222, 225);font-family:&quot;Andale Mono&quot;;line-height:1.6em">&lt;</td><td style="text-indent:1em;border-color:rgb(221, 222, 225);font-family:&quot;Andale Mono&quot;;line-height:1.6em">&amp;lt;</td><td style="text-indent:1em;border-color:rgb(221, 222, 225);line-height:1.6em">防止生成意外的 HTML</td></tr><tr><td style="text-indent:1em;border-color:rgb(221, 222, 225);font-family:&quot;Andale Mono&quot;;line-height:1.6em">&gt;</td><td style="text-indent:1em;border-color:rgb(221, 222, 225);font-family:&quot;Andale Mono&quot;;line-height:1.6em">&amp;gt;</td><td style="text-indent:1em;border-color:rgb(221, 222, 225);line-height:1.6em">防止生成意外的 HTML</td></tr><tr><td style="text-indent:1em;border-color:rgb(221, 222, 225);font-family:&quot;Andale Mono&quot;;line-height:1.6em">&amp;</td><td style="text-indent:1em;border-color:rgb(221, 222, 225);font-family:&quot;Andale Mono&quot;;line-height:1.6em">&amp;amp;</td><td style="text-indent:1em;border-color:rgb(221, 222, 225);line-height:1.6em">防止通过转义生成意外的代码</td></tr></tbody></table><p><strong>HTML 属性名：</strong></p><table class="tb-table"><tbody><tr><td style="background-color:#1c2838;text-indent:1em;border-color:rgb(73, 80, 96) rgb(73, 80, 96) rgb(221, 222, 225);border-left-color:rgb(73, 80, 96);border-top-color:rgb(73, 80, 96);border-right-color:rgb(73, 80, 96);border-bottom-color:rgb(221, 222, 225);color:rgb(233, 234, 236);line-height:1.6em">原字符</td><td style="background-color:#1c2838;text-indent:1em;border-color:rgb(73, 80, 96) rgb(73, 80, 96) rgb(221, 222, 225);border-left-color:rgb(73, 80, 96);border-top-color:rgb(73, 80, 96);border-right-color:rgb(73, 80, 96);border-bottom-color:rgb(221, 222, 225);color:rgb(233, 234, 236);line-height:1.6em">转义后</td><td style="background-color:#1c2838;text-indent:1em;border-color:rgb(73, 80, 96) rgb(73, 80, 96) rgb(221, 222, 225);border-left-color:rgb(73, 80, 96);border-top-color:rgb(73, 80, 96);border-right-color:rgb(73, 80, 96);border-bottom-color:rgb(221, 222, 225);color:rgb(233, 234, 236);line-height:1.6em">说明</td></tr><tr><td style="text-indent:1em;border-color:rgb(221, 222, 225);font-family:&quot;Andale Mono&quot;;line-height:1.6em">&lt;</td><td style="text-indent:1em;border-color:rgb(221, 222, 225);font-family:&quot;Andale Mono&quot;;line-height:1.6em">&amp;lt;</td><td style="text-indent:1em;border-color:rgb(221, 222, 225);line-height:1.6em">防止生成意外的 HTML<br></td></tr><tr><td style="text-indent:1em;border-color:rgb(221, 222, 225);font-family:&quot;Andale Mono&quot;;line-height:1.6em">&gt;</td><td style="text-indent:1em;border-color:rgb(221, 222, 225);font-family:&quot;Andale Mono&quot;;line-height:1.6em">&amp;gt;</td><td style="text-indent:1em;border-color:rgb(221, 222, 225);line-height:1.6em">防止生成意外的 HTML<br></td></tr><tr><td style="text-indent:1em;border-color:rgb(221, 222, 225);font-family:&quot;Andale Mono&quot;;line-height:1.6em">&amp;</td><td style="text-indent:1em;border-color:rgb(221, 222, 225);font-family:&quot;Andale Mono&quot;;line-height:1.6em">&amp;amp;</td><td style="text-indent:1em;border-color:rgb(221, 222, 225);line-height:1.6em">防止通过转义生成意外的代码<br></td></tr><tr><td style="text-indent:1em;border-color:rgb(221, 222, 225);font-family:&quot;Andale Mono&quot;;line-height:1.6em">"</td><td style="text-indent:1em;border-color:rgb(221, 222, 225);font-family:&quot;Andale Mono&quot;;line-height:1.6em">&amp;quot;<br></td><td style="text-indent:1em;border-color:rgb(221, 222, 225);line-height:1.6em">防止意外的属性值<br></td></tr><tr><td style="text-indent:1em;border-color:rgb(221, 222, 225);font-family:&quot;Andale Mono&quot;;line-height:1.6em">'</td><td style="text-indent:1em;border-color:rgb(221, 222, 225);font-family:&quot;Andale Mono&quot;;line-height:1.6em">&amp;#x27;<br></td><td style="text-indent:1em;border-color:rgb(221, 222, 225);line-height:1.6em">防止意外的属性值<br></td></tr></tbody></table><p><strong>HTML 属性值：</strong></p><table class="tb-table"><tbody><tr><td style="background-color:#1c2838;text-indent:1em;border-color:rgb(73, 80, 96) rgb(73, 80, 96) rgb(221, 222, 225);border-left-color:rgb(73, 80, 96);border-top-color:rgb(73, 80, 96);border-right-color:rgb(73, 80, 96);border-bottom-color:rgb(221, 222, 225);color:rgb(233, 234, 236);line-height:1.6em">原字符</td><td style="background-color:#1c2838;text-indent:1em;border-color:rgb(73, 80, 96) rgb(73, 80, 96) rgb(221, 222, 225);border-left-color:rgb(73, 80, 96);border-top-color:rgb(73, 80, 96);border-right-color:rgb(73, 80, 96);border-bottom-color:rgb(221, 222, 225);color:rgb(233, 234, 236);line-height:1.6em">转义后</td><td style="background-color:#1c2838;text-indent:1em;border-color:rgb(73, 80, 96) rgb(73, 80, 96) rgb(221, 222, 225);border-left-color:rgb(73, 80, 96);border-top-color:rgb(73, 80, 96);border-right-color:rgb(73, 80, 96);border-bottom-color:rgb(221, 222, 225);color:rgb(233, 234, 236);line-height:1.6em">说明</td></tr><tr><td style="text-indent:1em;border-color:rgb(221, 222, 225);font-family:&quot;Andale Mono&quot;;line-height:1.6em">"</td><td style="text-indent:1em;border-color:rgb(221, 222, 225);font-family:&quot;Andale Mono&quot;;line-height:1.6em">&amp;quot;<br></td><td style="text-indent:1em;border-color:rgb(221, 222, 225);line-height:1.6em">防止意外的属性值<br></td></tr><tr><td style="text-indent:1em;border-color:rgb(221, 222, 225);font-family:&quot;Andale Mono&quot;;line-height:1.6em">'</td><td style="text-indent:1em;border-color:rgb(221, 222, 225);font-family:&quot;Andale Mono&quot;;line-height:1.6em">&amp;#x27;<br></td><td style="text-indent:1em;border-color:rgb(221, 222, 225);line-height:1.6em">防止意外的属性值<br></td></tr></tbody></table><p><strong>超链接：</strong></p><p>过滤了如&nbsp;<code>href="<span style="color:rgb(231, 79, 94)">javascript:</span><span style="color:rgb(18, 150, 219)">alert</span>(<span style="color:rgb(231, 79, 94)">'xss'</span>);"</code>。</p><p><strong style="color:rgb(231, 79, 94)">如果你还有更多的策略要补充，欢迎联系通过 QQ 群联系我们！</strong></p><p><br></p><h1>国际化</h1><p>TextBus 支持国际化，默认语言为简体中文，官方有提供英文的语言包，你可以在创建编辑器之前，在配置项中添加，示例如下：</p><pre lang="Typescript" theme="dark"><div class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><code><span class="tb-hl-keyword">import</span>&nbsp;{ EditorOptions, i18n_en_US, createEditor }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/textbus'</span>;</code></div><div class="tb-code-line"><code><br></code></div><div class="tb-code-line"><code><span class="tb-hl-keyword">const</span>&nbsp;options: EditorOptions = {</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;<span class="tb-hl-comment">// 其它配置...</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;i18n: i18n_en_US</code></div><div class="tb-code-line"><code>}</code></div><div class="tb-code-line"><code><br></code></div><div class="tb-code-line"><code><span class="tb-hl-function">createEditor</span>(document.<span class="tb-hl-function">getElementById</span>(<span class="tb-hl-string">'editor'</span>), options);</code></div></div><div class="tb-pre-lang">Typescript</div></pre><p>如果你要自定义语言，请参考&nbsp;<a target="_blank" href="https:&#x2F;&#x2F;github.com&#x2F;tbhuabi&#x2F;textbus&#x2F;blob&#x2F;master&#x2F;src&#x2F;lib&#x2F;i18n&#x2F;zh_CN.ts">zh_CN</a>&nbsp;的结构配置自己的语言。</p><p style="color:rgb(18, 150, 219)">如何在自定义的扩展中实现国际化？</p><p>我们可以通过依赖注入的形式，注入&nbsp;<code>I18n</code>&nbsp;类，然后就可以动态获取到当前的语言配置了。我们以插件为例：</p><p>1、先准备好语言配置</p><pre lang="Typescript" theme="dark"><div class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><code><span class="tb-hl-keyword">import</span>&nbsp;{ I18NConfig, EditorOptions }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/textbus'</span>;</code></div><div class="tb-code-line"><code><br></code></div><div class="tb-code-line"><code><span class="tb-hl-keyword">const</span>&nbsp;customConfig: I18nConfig = {</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;<span class="tb-hl-comment">// ... 其它配置</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;plugins: {</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;example: {</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;title:&nbsp;<span class="tb-hl-string">'this is demo info'</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;}</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;}</code></div><div class="tb-code-line"><code>}</code></div><div class="tb-code-line"><code><br></code></div><div class="tb-code-line"><code><span class="tb-hl-comment">// 在配置项中使用自定义配置</span></code></div><div class="tb-code-line"><code><span class="tb-hl-keyword">const</span>&nbsp;options: EditorOptions = {</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;i18n: customConfig</code></div><div class="tb-code-line"><code>}</code></div></div><div class="tb-pre-lang">Typescript</div></pre><p>2、在插件中应用配置</p><pre lang="Typescript" theme="dark"><div class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><code><span class="tb-hl-keyword">import</span>&nbsp;{ Injectable, I18n, TBPlugin }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/textbus'</span>;</code></div><div class="tb-code-line"><code><br></code></div><div class="tb-code-line"><code>@<span class="tb-hl-function">Injectable</span>()</code></div><div class="tb-code-line"><code><span class="tb-hl-keyword">export</span>&nbsp;ExamplePlugin&nbsp;<span class="tb-hl-keyword">implements</span>&nbsp;<span class="tb-hl-class-name">TBPlugin</span>&nbsp;{</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;<span class="tb-hl-keyword">constructor</span>(<span class="tb-hl-keyword">private</span>&nbsp;i18n: I18n) {}</code></div><div class="tb-code-line"><code><br></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;<span class="tb-hl-function">setup</span>() {</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// I18n 类会优先查找你的国际化配置信息，如果找不到，则会从默认配置里查找，如果都找不到，则返回一个空字符串</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 你应该始终通过 I18n 类获取对应配置，而不要直接引入，以防止访问到不存在的属性时，引发程序报错。</span></code></div><div class="tb-code-line"><code>&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-builtin">console</span>.<span class="tb-hl-function">log</span>(<span class="tb-hl-keyword">this</span>.i18n.<span class="tb-hl-keyword">get</span>(<span class="tb-hl-string">'plugins.example.title'</span>))</code></div><div class="tb-code-line"><code>&nbsp;&nbsp;}</code></div><div class="tb-code-line"><code>}</code></div></div><div class="tb-pre-lang">Typescript</div></pre><p><br></p>
</template>

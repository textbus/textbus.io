<script setup lang="ts">
import { useDocUpdate } from '@/hooks/use-doc-update';
import { ref } from 'vue';

const doc = ref<HTMLElement>()
useDocUpdate(doc)
</script>
<template>
  <div ref="doc">
    <h1>组件</h1>
<p>什么是 TextBus 的组件？</p>
<p>我们应当都使用过现代前端框架，如 React、Vue、Angular 等，如果你有使用过，那么你会在轻松的上手。如果你没用使用过前端的框架，也没关系，只要阅读下面的文档，你一样可以快速开发出来。&nbsp;</p>
<p>组件带给我们良好的封装、丰富的功能、易于维护和扩展的开发体验。使用 TextBus 开发富文本组件，也可以像前端框架一样，只需要掌握少量的 API 以及生命周期等，即可开发出令人惊叹的富文本组件。当然，TextBus 的组件也有自己的特有的功能，如自动记录操作历史，支持插槽编辑等，不过，你基本无需关心这些，因为 TextBus 的内核已经帮你做好了。</p>
<p>要创建 TextBus 的组件，只需要调用&nbsp;<code>defineComponent</code>&nbsp;函数，并编写特定的配置项即可。 一个简单的组件如下：</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ defineComponent, ContentType, useSlots, Slot, VElement }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/core'</span></span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">export</span>&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;myComponent =&nbsp;<span class="tb-hl-function">defineComponent</span>({</span><span class="tb-code-line">&nbsp;&nbsp;type: ContentType.InlineComponent,&nbsp;<span class="tb-hl-comment">// 设置组件类型</span></span><span class="tb-code-line">&nbsp;&nbsp;name:&nbsp;<span class="tb-hl-string">'MyComponent'</span>, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 组件的名字，不可重复</span></span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">transform</span>(translator, state) { &nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 将当前组件 json 数据转换为实例</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;state</span><span class="tb-code-line">&nbsp;&nbsp;},</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">setup</span>() {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;{</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">render</span>(isOutputMode, slotRender) {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;(</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VElement.<span class="tb-hl-function">createElement</span>(<span class="tb-hl-string">'my-component'</span>,&nbsp;<span class="tb-hl-keyword">null</span>, [</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VElement.<span class="tb-hl-function">createElement</span>(<span class="tb-hl-string">'span'</span>,&nbsp;<span class="tb-hl-keyword">null</span>, [<span class="tb-hl-string">'这是我的第一个组件'</span>])</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;])</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">toJSON</span>() {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;returtn {}</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="tb-code-line">&nbsp;&nbsp;}</span><span class="tb-code-line">})</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<blockquote>
  <p>TextBus 组件支持用 jsx 或 tsx 编写，也可以用&nbsp;<code>new VElement('p')</code>&nbsp;或者&nbsp;<code>new VTextNode('text')</code>&nbsp;的方式编写。</p>
</blockquote>
<h2>组件选项</h2>
<p>上面的示例是一个最简单的组件，但它基本包含了 TextBus 组件的基本形态，更复杂的组件，无非是在这个基础上增加更多的逻辑而已。在开发组件之前，我们需要先理解示例中的几个配置项。</p>
<h3>type</h3>
<p>组件类型。在 TextBus 的数据定义中，共有三种数据类型，它们分别是：</p>
<ul>
  <li><strong>块组件</strong>：ContentType.BlockComponent</li>
  <li><strong>行内组件</strong>：Component.InlineComponent</li>
  <li><strong>文本</strong>：ContentType.Text</li>
</ul>
<p>需要注意的是，这里定义的块组件和行内组件，在展示上并不总是和 HTML 是一样的，它只是 TextBus 用于计算格式变换和结构变换的依据。事实上，你完全可以定义一个块组件，但让它显示效果像一个行内组件，亦或是相反。不过，我们还是建议你在定义组件类型的时候，尽量和展示效果保持一致。</p>
<h3>name</h3>
<p>组件的名字，在一个 TextBus 实例中，它<strong style="color:rgb(231, 79, 94)">必须是唯一</strong>的。TextBus 在查找和储存历史记录时，都会用到它。</p>
<h3>transform()</h3>
<p>数据转换方法。TextBus 不会限制组件的数据模型结构，所以也就不知道如何把一个 JSON 数据转换成编辑器所需的组件或插槽的实例，所以需要我们在此处帮助 TextBus 来转换数据。如果你的组件没有定义一些状态数据或插槽，那么只需要原样把 state 返回就可以了<span style="color:rgb(128, 132, 143);font-size:15px">（没有插槽或状态，这里往往是 null 或者 undefined）</span>，否则，你需要把你转换好的数据返回。</p>
<ul>
  <li>translator —— TextBus 提供的用于数据自动转换的类，可以根据数据创建组件或插槽的实例。</li>
  <li>state —— 组件的数据模型，根据你的组件的定义不同而不同。</li>
</ul>
<h3>setup()</h3>
<p>组件的核心方法。你可以在该方法内定义组件的行为、数据和渲染函数。一个 TextBus 必须要返回一个含有 render() 方法和 toJSON() 方法的对象。其中，render 方法返回的是组件的虚拟 DOM，toJSON 方法返回的是组件的 JSON 字面量。</p>
<h2>组件加载器</h2>
<p>在上面的文档中，我们已经知道，我们的组件可以用一个 JSON 表示，这当然很美好，但普通用户可能更需要一个直接编辑 HTML 的编辑器。并且，在浏览器中，我们的复制、粘贴行为，也只能是 HTML，所以，我们还需要创建一个组件加载器，才可以让我们的组件在浏览器中正常运行。</p>
<p>我们还是以上面的组件为例：</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;myComponentLoader = {</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">// 匹配一个 DOM 元素是否为 myComponent</span></span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">match</span>(element) {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;element.tagName.<span class="tb-hl-function">toLowerCase</span>() ===&nbsp;<span class="tb-hl-string">'my-component'</span></span><span class="tb-code-line">&nbsp;&nbsp;},</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">// 如果匹配成功，则调用 read 方法，我们可以在这里创建组件的实例并返回</span></span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">read</span>(element, injector) {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;myComponent.<span class="tb-hl-function">createInstance</span>(injector)</span><span class="tb-code-line">&nbsp;&nbsp;},</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">// 把组件和加载器绑定在一起</span></span><span class="tb-code-line">&nbsp;&nbsp;component: myComponent</span><span class="tb-code-line">}</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<h3>match()</h3>
<p>用于匹配一个 DOM 元素是否是我们定义的组件，在 myComponentLoader 内，我们用标签名判断。我们也完全可以用元素的属性、className 等来作为判断条件。这根据你定义的组件的不同而不同。</p>
<h3>read()</h3>
<p>当 match 方法返回 true 时，则会调用 read 方法来读取组件的具体内容。由于 myComponent 组件不需要读取任何内容，我们直接返回 myComponent 组件的实例即可。</p>
<p>read 方法会传入三个参数，分别为：</p>
<ul>
  <li>element：match 方法匹配到的 DOM 元素</li>
  <li>injector：编辑器实例的 IoC 容器</li>
  <li>slotParser：一个函数，可以把一个 DOM 元素的内容读取到插槽内。<pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-function">read</span>(element, injector, slotParser) {</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">// 如果你的组件带有插槽的话，则需要用 slotParser 读取插槽内容</span></span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;slot =&nbsp;<span class="tb-hl-keyword">new</span>&nbsp;<span class="tb-hl-class-name">Slot</span>([ContentType.Text])</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">slotParser</span>(slot, element)</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;yourComponent.<span class="tb-hl-function">createInstance</span>(injector, slot)</span><span class="tb-code-line">}</span></span><span class="tb-pre-lang">TypeScript</span></pre>
  </li>
</ul>
<h3>component</h3>
<p>组件加载器对应的组件。</p>
<h2>使用组件</h2>
<p>现在我们在编辑器中添加我们刚创建的组件。</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ Editor }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/editor'</span></span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;editor =&nbsp;<span class="tb-hl-keyword">new</span>&nbsp;<span class="tb-hl-class-name">Editor</span>(<span class="tb-hl-string">'#editor'</span>, {</span><span class="tb-code-line">&nbsp;&nbsp;componentLoaders: [</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;myComponentLoader</span><span class="tb-code-line">&nbsp;&nbsp;]</span><span class="tb-code-line">})</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<p>我们还需要添加一个按钮，点击按钮后往文档中插入 MyComponent 组件。</p><pre lang="HTML"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line">&lt;<span class="tb-hl-tag">div&nbsp;</span><span class="tb-hl-attr-name">class</span>="<span class="tb-hl-attr-value">toolbar</span>"&gt;</span><span class="tb-code-line">&nbsp;&nbsp;&lt;<span class="tb-hl-tag">button&nbsp;</span><span class="tb-hl-attr-name">type</span>="<span class="tb-hl-attr-value">button</span>"<span class="tb-hl-tag">&nbsp;</span><span class="tb-hl-attr-name">id</span>="<span class="tb-hl-attr-value">insert-my-component</span>"&gt;插入 MyComponent&lt;/<span class="tb-hl-tag">button</span>&gt;</span><span class="tb-code-line">&lt;/<span class="tb-hl-tag">div</span>&gt;</span><span class="tb-code-line">&lt;<span class="tb-hl-tag">div&nbsp;</span><span class="tb-hl-attr-name">id</span>="<span class="tb-hl-attr-value">editor</span>"&gt;&lt;/<span class="tb-hl-tag">div</span>&gt;</span></span><span class="tb-pre-lang">HTML</span></pre><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ Commander, ContentType }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/core'</span></span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ myComponent }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'./my-component'</span></span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;insertBtn = document.<span class="tb-hl-function">getElementById</span>(<span class="tb-hl-string">'insert-my-component'</span>)</span><span class="tb-code-line"><br></span><span class="tb-code-line">editor.onReady.<span class="tb-hl-function">subscribe</span>(() =&gt; {</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;injector = editor.injector</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;commander = injector.<span class="tb-hl-function">get</span>(Commander)</span><span class="tb-code-line"><br></span><span class="tb-code-line">&nbsp;&nbsp;insertBtn.<span class="tb-hl-function">addEventListener</span>(<span class="tb-hl-string">'click'</span>, () =&gt; {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;componentInstance = myComponent.<span class="tb-hl-function">createInstance</span>(injector)</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;commander.<span class="tb-hl-function">insert</span>(componentInstance)</span><span class="tb-code-line">&nbsp;&nbsp;})</span><span class="tb-code-line">})</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<p>你也可以在创建编辑器时，把 myComponent 的 HTML 配置在 content 属性中。TextBus 会调用 loader 的来实现组件的实例化。</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;editor =&nbsp;<span class="tb-hl-keyword">new</span>&nbsp;<span class="tb-hl-class-name">Editor</span>(<span class="tb-hl-string">'#editor'</span>, {</span><span class="tb-code-line">&nbsp;&nbsp;componentLoaders: [</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;myComponentLoader</span><span class="tb-code-line">&nbsp;&nbsp;],</span><span class="tb-code-line">&nbsp;&nbsp;content:&nbsp;<span class="tb-hl-string">'&lt;my-component&gt;&lt;span&gt;这是我的第一个组件&lt;/span&gt;&lt;/my-component&gt;'</span></span><span class="tb-code-line">})</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<h2>带插槽的组件</h2>
<p>上面的示例中，myComponent 组件只是一段 HTML 的封装，而没有其它任何功能和数据交互。如果你把它插入到文档中，你会发现，你无法用光标去编辑 myComponent 组件的任何内容，而是要么添加，要么删除。这是 TextBus 的组件的特点，在组件内的 DOM 节点和内容，是无法编辑的<span style="color:rgb(128, 132, 143);font-size:15px">（组件自己的方法可以更改）</span>。</p>
<p>要让组件内的内容可以通过光标编辑，我们需要给组件添加插槽。我们以开发一个可设置风格的警告框为例。</p>
<p>在正式编写组件之前，我们先定义组件的数据模型：</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ SlotLiteral, Slot }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/core'</span></span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-comment">// 组件的 JSON 表示</span></span><span class="tb-code-line"><span class="tb-hl-keyword">interface</span>&nbsp;<span class="tb-hl-class-name">MyComponentState</span>&nbsp;{</span><span class="tb-code-line">&nbsp;&nbsp;type:&nbsp;<span class="tb-hl-string">'primary'</span>&nbsp;|&nbsp;<span class="tb-hl-string">'success'</span>&nbsp;|&nbsp;<span class="tb-hl-string">'danger'</span>&nbsp;<span class="tb-hl-comment">// 组件的三种风格</span></span><span class="tb-code-line">&nbsp;&nbsp;content: SlotLiteral&nbsp;<span class="tb-hl-comment">// 插槽的 JSON 表示</span></span><span class="tb-code-line">}</span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-comment">// 组件的数据</span></span><span class="tb-code-line"><span class="tb-hl-keyword">interface</span>&nbsp;<span class="tb-hl-class-name">MyComponentData</span>&nbsp;{</span><span class="tb-code-line">&nbsp;&nbsp;type:&nbsp;<span class="tb-hl-string">'primary'</span>&nbsp;|&nbsp;<span class="tb-hl-string">'success'</span>&nbsp;|&nbsp;<span class="tb-hl-string">'danger'</span>&nbsp;<span class="tb-hl-comment">// 组件的三种风格</span></span><span class="tb-code-line">&nbsp;&nbsp;content: Slot&nbsp;<span class="tb-hl-comment">// 插槽的实例</span></span><span class="tb-code-line">}</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<p>定义好了数据模型，我们就可以真正开始我们的组件编写了。</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ ContentType, useSlots, ContentType }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/core'</span></span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;alertComponent =&nbsp;<span class="tb-hl-function">defineComponent</span>({</span><span class="tb-code-line">&nbsp;&nbsp;type: ContentType.BlockComponet,</span><span class="tb-code-line">&nbsp;&nbsp;name:&nbsp;<span class="tb-hl-string">'AlertComponent'</span>,</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">// state 即为 MyComponentState，返回值为 MyComponentData</span></span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">transform</span>(translator, state) {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;{</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type: state.type,</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 把插槽的 JSON 转换为 Slot 实例</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;content: translator.<span class="tb-hl-function">createSlot</span>(state.content)</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="tb-code-line">&nbsp;&nbsp;},</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">// data 为 transform 方法返回的数据</span></span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">setup</span>(data) {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 把插槽注册 TextBus 数据树中，使用插槽能够被修改</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;slots =&nbsp;<span class="tb-hl-function">useSlots</span>([data.content], () =&gt; {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 当插槽删除被撤消后，返回新的插槽实例</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;<span class="tb-hl-keyword">new</span>&nbsp;<span class="tb-hl-class-name">Slot</span>([ContentType.Text])</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;})</span><span class="tb-code-line"><br></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">let</span>&nbsp;state = {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type: data.<span class="tb-hl-keyword">type</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="tb-code-line"><br></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;stateController =&nbsp;<span class="tb-hl-function">useState</span>(state)</span><span class="tb-code-line"><br></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;subscription = stateController.onChange.<span class="tb-hl-function">subscribe</span>(newState =&gt; {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 监听状态变化，并使用新状态</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state = newState</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;})</span><span class="tb-code-line"><br></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">function</span>&nbsp;<span class="tb-hl-function">updateType</span>(type) {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;stateController.<span class="tb-hl-function">update</span>(darft =&gt; {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;draft.type =&nbsp;<span class="tb-hl-keyword">type</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="tb-code-line"><br></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;{</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">render</span>(isOutputMode, slotRender) {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;(</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;<span class="tb-hl-keyword">class</span>={<span class="tb-hl-string">'alert '</span>&nbsp;+ state.type}&gt;</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 判断是否是编辑模式，如果是，则渲染三个按钮用来设置风格，否则不输出节点</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 当虚拟 DOM 节点值为 false 时，会被忽略</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;isOutputMode ?</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-boolean">false</span>&nbsp;:</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&lt;div&gt;</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button type=<span class="tb-hl-string">"button"</span>&nbsp;onClick={() =&gt;&nbsp;<span class="tb-hl-function">updateType</span>(<span class="tb-hl-string">'primary'</span>)}&gt;设置为 Primary&lt;/button&gt;</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button type=<span class="tb-hl-string">"button"</span>&nbsp;onClick={() =&gt;&nbsp;<span class="tb-hl-function">updateType</span>(<span class="tb-hl-string">'success'</span>)}&gt;设置为 Success&lt;/button&gt;</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button type=<span class="tb-hl-string">"button"</span>&nbsp;onClick={() =&gt;&nbsp;<span class="tb-hl-function">updateType</span>(<span class="tb-hl-string">'danger'</span>)}&gt;设置为 Danger&lt;/button&gt;</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;)</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">slotRender</span>(slots.<span class="tb-hl-function">get</span>(<span class="tb-hl-number">0</span>), () =&gt; {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;&lt;div&nbsp;<span class="tb-hl-keyword">class</span>=<span class="tb-hl-string">"alert-content"</span>/&gt;</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="tb-code-line">&nbsp;&nbsp;}</span><span class="tb-code-line">})</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<p>编写组件加载器。</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;alertComponentLoader = {</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">match</span>(element) {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;element.tagName ===&nbsp;<span class="tb-hl-string">'div'</span>&nbsp;&amp;&amp; element.classList.<span class="tb-hl-function">contains</span>(<span class="tb-hl-string">'alert'</span>)</span><span class="tb-code-line">&nbsp;&nbsp;},</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">read</span>(element, injector, slotParser) {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;type =&nbsp;<span class="tb-hl-string">''</span>;</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">if</span>&nbsp;(element.classList.<span class="tb-hl-function">contains</span>(<span class="tb-hl-string">'primary'</span>)) {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type =&nbsp;<span class="tb-hl-string">'primary'</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span class="tb-hl-keyword">else</span>&nbsp;<span class="tb-hl-keyword">if</span>&nbsp;(element.classList.<span class="tb-hl-function">contains</span>(<span class="tb-hl-string">'success'</span>)) {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type =&nbsp;<span class="tb-hl-string">'success'</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span class="tb-hl-keyword">else</span>&nbsp;<span class="tb-hl-keyword">if</span>&nbsp;(element.classList.<span class="tb-hl-function">contains</span>(<span class="tb-hl-string">'danger'</span>)) {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type =&nbsp;<span class="tb-hl-string">'danger'</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="tb-code-line"><br></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;slot =&nbsp;<span class="tb-hl-keyword">new</span>&nbsp;<span class="tb-hl-class-name">Slot</span>([ContentType.Text])</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">slotParser</span>(slot, element.children[<span class="tb-hl-number">1</span>])</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;alertComponent.<span class="tb-hl-function">createInstance</span>(injector, {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type,</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;content: slot</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;})</span><span class="tb-code-line">&nbsp;&nbsp;},</span><span class="tb-code-line">&nbsp;&nbsp;component: alertComponent</span><span class="tb-code-line">}</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<p>现在，我们把 alertComponentLoader 添加到编辑器中。</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;editor =&nbsp;<span class="tb-hl-function">createEditor</span>(<span class="tb-hl-string">'#editor'</span>, {</span><span class="tb-code-line">&nbsp;&nbsp;componentLoaders: [</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;myComponentLoader,</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;alertComponentLoader</span><span class="tb-code-line">&nbsp;&nbsp;]</span><span class="tb-code-line">})</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<h3>应用新组件</h3>
<p>添加一个按钮，点击时插入一个新的 alertComponent 组件到文档内。</p><pre lang="HTML"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line">&lt;<span class="tb-hl-tag">div&nbsp;</span><span class="tb-hl-attr-name">class</span>="<span class="tb-hl-attr-value">toolbar</span>"&gt;</span><span class="tb-code-line">&nbsp;&nbsp;&lt;<span class="tb-hl-tag">button&nbsp;</span><span class="tb-hl-attr-name">type</span>="<span class="tb-hl-attr-value">button</span>"<span class="tb-hl-tag">&nbsp;</span><span class="tb-hl-attr-name">id</span>="<span class="tb-hl-attr-value">insert-my-component</span>"&gt;插入 MyComponent&lt;/<span class="tb-hl-tag">button</span>&gt;</span><span class="tb-code-line">&nbsp;&nbsp;&lt;<span class="tb-hl-tag">button&nbsp;</span><span class="tb-hl-attr-name">type</span>="<span class="tb-hl-attr-value">button</span>"<span class="tb-hl-tag">&nbsp;</span><span class="tb-hl-attr-name">id</span>="<span class="tb-hl-attr-value">insert-alert-component</span>"&gt;插入 AlertComponent&lt;/<span class="tb-hl-tag">button</span>&gt;</span><span class="tb-code-line">&lt;/<span class="tb-hl-tag">div</span>&gt;</span><span class="tb-code-line">&lt;<span class="tb-hl-tag">div&nbsp;</span><span class="tb-hl-attr-name">id</span>="<span class="tb-hl-attr-value">editor</span>"&gt;&lt;/<span class="tb-hl-tag">div</span>&gt;</span></span><span class="tb-pre-lang">HTML</span></pre><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ Commander, ContentType }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/core'</span></span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ myComponent }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'./my-component'</span></span><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ alertComponent }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'./alert-component'</span></span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;insertBtn = document.<span class="tb-hl-function">getElementById</span>(<span class="tb-hl-string">'insert-my-component'</span>)</span><span class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;insertBtn2 = document.<span class="tb-hl-function">getElementById</span>(<span class="tb-hl-string">'insert-alert-component'</span>)</span><span class="tb-code-line"><br></span><span class="tb-code-line">editor.onReady.<span class="tb-hl-function">subscribe</span>(() =&gt; {</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;injector = editor.injector</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;commander = injector.<span class="tb-hl-function">get</span>(Commander)</span><span class="tb-code-line"><br></span><span class="tb-code-line">&nbsp;&nbsp;insertBtn.<span class="tb-hl-function">addEventListener</span>(<span class="tb-hl-string">'click'</span>, () =&gt; {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;componentInstance = myComponent.<span class="tb-hl-function">createInstance</span>(injector)</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;commander.<span class="tb-hl-function">insert</span>(componentInstance)</span><span class="tb-code-line">&nbsp;&nbsp;})</span><span class="tb-code-line">&nbsp;&nbsp;insertBtn2.<span class="tb-hl-function">addEventListener</span>(<span class="tb-hl-string">'click'</span>, () =&gt; {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;componentInstance = alertComponent.<span class="tb-hl-function">createInstance</span>(injector)</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;commander.<span class="tb-hl-function">insert</span>(componentInstance)</span><span class="tb-code-line">&nbsp;&nbsp;})</span><span class="tb-code-line">})</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<blockquote>
  <p><strong style="color:rgb(231, 79, 94)">一个组件可以没有插槽，也可以有任意个插槽，你可以根据自己的需要定制。</strong></p>
</blockquote>
<h2>TSX 配置</h2>
<p>使用命令式编写组件的虚拟 DOM 无疑是一个比较麻烦和容易出错的方式，在 TextBus 中，我们可以使用 jsx / tsx 编写 TextBus 组件，前提是你需要配置相应环境才可以正确编译。</p>
<p>在上面的示例中，我们看到了使用 VElement.createElement 的方式创建虚拟 DOM，这和 React 的工厂方法是类似的。有了这个基础，我们就可以通过 tsx 的方式来编写组件了。</p>
<p>要用 tsx 编写组件首先要在项目中的 tsconfig.json 中添加如下声明：</p><pre lang="JSON"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line">{</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-attr-name">"compilerOptions"</span>: {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-attr-name">"jsx"</span>:&nbsp;<span class="tb-hl-string">"react"</span>,</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-attr-name">"jsxFactory"</span>:&nbsp;<span class="tb-hl-string">"VElement.createElement"</span></span><span class="tb-code-line">&nbsp;&nbsp;}</span><span class="tb-code-line">}</span></span><span class="tb-pre-lang">JSON</span></pre>
<p>同时在项目的根目录添加一个类型声明文件，如 typings.d.ts，并声明如下类型：</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-comment">// #typings.d.ts</span></span><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ VElement }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/core'</span>;</span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">declare</span>&nbsp;<span class="tb-hl-keyword">namespace</span>&nbsp;JSX {</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-keyword">interface</span>&nbsp;<span class="tb-hl-class-name">Element</span>&nbsp;<span class="tb-hl-keyword">extends</span>&nbsp;<span class="tb-hl-class-name">VElement</span>&nbsp;{</span><span class="tb-code-line">&nbsp;&nbsp;}</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-keyword">interface</span>&nbsp;<span class="tb-hl-class-name">IntrinsicElements</span>&nbsp;{</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;[elemName:&nbsp;<span class="tb-hl-builtin">string</span>]:&nbsp;<span class="tb-hl-builtin">any</span></span><span class="tb-code-line">&nbsp;&nbsp;}</span><span class="tb-code-line">}</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<p>以上配置适用于在整个项目只有一种 tsx 类型的情况，如果在 Vue/React 项目中，以上声明会导致 TextBus 的虚拟 DOM 工厂函数和 Vue/React 的虚拟 DOM 工厂函数发生冲突。同时，Vue cli 的 ts 项目的编译方式和 React 项目的编辑方式还有所不同，我们需要分别处理。</p>
<p>在 Vue + ts 的项目中，我们通过 vue cli 创建项目时，需选择自定义创建，在命令行中，不要选择通过 babel 编译 jsx。即去掉 babel，默认用 ts 的编译器编辑 tsx。这时，编译流程就由 vue 默认的 tsx -&gt; jsx -&gt; babel -&gt; js 的方式，改为 tsx - js。我们再把 vue cli 生成的 tsconfig.json 编译配置中的 tsx 选项由 preserve 改为 react。</p>
<p>这时，Vue 和 React 的编译方式就可以统一了，当我们在具体的 tsx 文件中，通过注释的方式声明 tsx 工厂函数即可。</p>
<p>如果是 TextBus 的组件，我们在文件头部作如下声明：</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-comment">/** @jsx VElement.createElement */</span>&nbsp;</span><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ VElement }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/textbus'</span>;</span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-comment">// your code</span></span></span><span class="tb-pre-lang">TypeScript</span></pre>
<p>如果是 Vue 组件，我们在文件头部作如下声明：</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-comment">/** @jsx h */</span>&nbsp;</span><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ h }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'vue'</span>;</span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-comment">// your code</span></span></span><span class="tb-pre-lang">TypeScript</span></pre>
<p>如果果 React 组件，我们在文件头部作如下声明：</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-comment">/** @jsx createElement */</span>&nbsp;</span><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ createElement }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'react'</span>;</span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-comment">// your code</span></span></span><span class="tb-pre-lang">TypeScript</span></pre>
<blockquote>
  <p>如果你不想使用 TypeScript，而是用 JavaScript &nbsp;开发，你还可以用 babel 来转换 jsx，babel 自定义 jsx 工厂函数的方法，请使用搜索引擎或 babel 官网查看相关文档。</p>
</blockquote>
  </div>
</template>
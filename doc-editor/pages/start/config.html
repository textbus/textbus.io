<h1>配置</h1>
<p>通过配置，你可以定制编辑器的行为、功能、插件、格式等。自定义配置的方式如下</p><pre lang="TypeScript"><div style="width:2em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ createEditor }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/editor'</span>;</div><div class="tb-code-line"><br></div><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;options = {</div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">// 这里是配置项</span></div><div class="tb-code-line">}</div><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;editor =&nbsp;<span class="tb-hl-function">createEditor</span>(document.<span class="tb-hl-function">getElementById</span>(<span class="tb-hl-string">'editor'</span>), options)</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<p>通过 createEditor 函数创建编辑器时，你配置的字段会覆盖默认的配置，如你配置了 placeholder，则会覆盖掉默认的 placeholder，但其它的配置项还会使用默认值。</p>
<h2>默认配置</h2>
<p>通过 createEditor 函数创建编辑器时，会使用默认配置，详情如下：</p><pre lang="TypeScript"><div style="width:2em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-comment">// 默认配置项</span></div><div class="tb-code-line"><span class="tb-hl-keyword">export</span>&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;defaultOptions: EditorOptions = {</div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">// 编辑时的文档样式</span></div><div class="tb-code-line">&nbsp;&nbsp;editingStyleSheets: [</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-string">`[style*=color]:not([style*=background-color]) a {color: inherit;}`</span>,</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-string">`a {text-decoration: underline; color: #449fdb; cursor: text;}`</span></div><div class="tb-code-line">&nbsp;&nbsp;],</div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">// 文档样式</span></div><div class="tb-code-line">&nbsp;&nbsp;styleSheets: [</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-string">`body {line-height: 1.5em}`</span></div><div class="tb-code-line">&nbsp;&nbsp;],</div><div class="tb-code-line">&nbsp;&nbsp;componentLoaders: [</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;audioComponentLoader,&nbsp;<span class="tb-hl-comment">// 音频组件</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;blockComponentLoader,&nbsp;<span class="tb-hl-comment">// 块组件（div)</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;blockquoteComponentLoader,&nbsp;<span class="tb-hl-comment">// 引用块组件</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;headingComponentLoader,&nbsp;<span class="tb-hl-comment">// 标题组件(h1~h6)</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;imageComponentLoader,&nbsp;<span class="tb-hl-comment">// 图片组件</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;listComponentLoader,&nbsp;<span class="tb-hl-comment">// 列表组件（ul、ol)</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;paragraphComponentLoader,&nbsp;<span class="tb-hl-comment">// 段落组件</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;preComponentLoader,&nbsp;<span class="tb-hl-comment">// 代码块组件</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;tableComponentLoader,&nbsp;<span class="tb-hl-comment">// 表格组件</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;videoComponentLoader&nbsp;<span class="tb-hl-comment">// 视频组件</span></div><div class="tb-code-line">&nbsp;&nbsp;],</div><div class="tb-code-line">&nbsp;&nbsp;formatLoaders: [</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;boldFormatLoader,&nbsp;<span class="tb-hl-comment">// 加粗</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;italicFormatLoader,&nbsp;<span class="tb-hl-comment">// 斜体</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;colorFormatLoader,&nbsp;<span class="tb-hl-comment">// 文字颜色</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;fontFamilyFormatLoader,&nbsp;<span class="tb-hl-comment">// 字体</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;fontSizeFormatLoader,&nbsp;<span class="tb-hl-comment">// 文字大小</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;letterSpacingFormatLoader,&nbsp;<span class="tb-hl-comment">// 文字间距</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;lineHeightFormatLoader,&nbsp;<span class="tb-hl-comment">// 行高</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;strikeThroughFormatLoader,&nbsp;<span class="tb-hl-comment">// 中划线</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;subscriptFormatLoader,&nbsp;<span class="tb-hl-comment">// 下标</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;superscriptFormatLoader,&nbsp;<span class="tb-hl-comment">// 上标</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;underlineFormatLoader,&nbsp;<span class="tb-hl-comment">// 下划线</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;codeFormatLoader,&nbsp;<span class="tb-hl-comment">// 代码</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;blockBackgroundColorFormatLoader,&nbsp;<span class="tb-hl-comment">// 块级背影色</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;linkFormatLoader,&nbsp;<span class="tb-hl-comment">// 超链接</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;textBackgroundColorFormatLoader,&nbsp;<span class="tb-hl-comment">// 文字背影颜色</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;textAlignFormatLoader,&nbsp;<span class="tb-hl-comment">// 对齐方式</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;textIndentFormatLoader,&nbsp;<span class="tb-hl-comment">// 首行缩进</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;verticalAlignFormatLoader,&nbsp;<span class="tb-hl-comment">// 垂直对齐</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;dirFormatLoader&nbsp;<span class="tb-hl-comment">// 排版方向</span></div><div class="tb-code-line">&nbsp;&nbsp;]</div><div class="tb-code-line">}</div><div class="tb-code-line"><br></div><div class="tb-code-line"><span class="tb-hl-keyword">export</span>&nbsp;<span class="tb-hl-keyword">function</span>&nbsp;<span class="tb-hl-function">createEditor</span>(selector:&nbsp;<span class="tb-hl-builtin">string</span>&nbsp;| HTMLElement, options: EditorOptions = {}) {</div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">// 全并配置项，并返回 Editor 实例</span></div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;<span class="tb-hl-keyword">new</span>&nbsp;<span class="tb-hl-class-name">Editor</span>(selector, {</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;...defaultOptions,</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;plugins: [</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 工具条插件</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">new</span>&nbsp;<span class="tb-hl-class-name">Toolbar</span>([</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[historyBackTool, historyForwardTool],&nbsp;<span class="tb-hl-comment">// 历史记录后退、历史记录前进</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[defaultGroupTool],&nbsp;<span class="tb-hl-comment">// 默认工具组</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[headingTool],&nbsp;<span class="tb-hl-comment">// 标题</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[boldTool, italicTool, strikeThroughTool, underlineTool],&nbsp;<span class="tb-hl-comment">// 加精、斜体、中划线、下划线</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[olTool, ulTool],&nbsp;<span class="tb-hl-comment">// 有序列表、无序列表</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[fontSizeTool, textIndentTool],&nbsp;<span class="tb-hl-comment">// 文字大小、首行缩进</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[colorTool, textBackgroundTool],&nbsp;<span class="tb-hl-comment">// 文字颜色、文字背景颜色</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[insertParagraphBeforeTool, insertParagraphAfterTool],&nbsp;<span class="tb-hl-comment">// 向前插入段落、向后插入段落</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[fontFamilyTool],&nbsp;<span class="tb-hl-comment">// 字体</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[linkTool, unlinkTool],&nbsp;<span class="tb-hl-comment">// 超链接、取消超链接</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[imageTool],&nbsp;<span class="tb-hl-comment">// 图片</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[textAlignTool],&nbsp;<span class="tb-hl-comment">// 对齐方式</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[tableAddTool, tableRemoveTool],&nbsp;<span class="tb-hl-comment">// 添加表格、删除表格</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[cleanTool]&nbsp;<span class="tb-hl-comment">// 格式清除</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]),</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 超链接弹出跳转提示插件</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">new</span>&nbsp;<span class="tb-hl-class-name">LinkJumpTipPlugin</span>()</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;],</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 你的自定义配置</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;...options</div><div class="tb-code-line">&nbsp;&nbsp;})</div><div class="tb-code-line">}</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<p>注意：默认配置有可能<strong style="color:rgb(231, 79, 94)">随着版本更新而改变</strong>，你可以参考源代码。</p>
<h2>配置项</h2>
<h3>组件 componentLoaders</h3>
<p>componentLoaders 为一个数组，可以配置编辑器支持的组件。TextBus 开发了常见的组件，如果你有自定义组件，你应该把你的组件和 TextBus 的组件一起放在这里。你也可以不配置 TextBus<br>默认的组件，则编辑器只会支持你自定义的组件。<br></p><pre lang="TypeScript"><div style="width:2em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;options = {</div><div class="tb-code-line">&nbsp;&nbsp;componentLoaders: [</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 组件列表</span></div><div class="tb-code-line">&nbsp;&nbsp;]</div><div class="tb-code-line">}</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<p>查看<a target="_self" href="/docs/component">组​件开发</a>文档</p>
<h3>格式 formatLoaders</h3>
<p>formatLoaders 为一个数组，可以配置编辑器支持的格式。TextBus 已开发了常见的格式，如果你有自定义格式，你应该把你的格式和 TextBus 的格式一起放在这里。</p>
<p>你也可以不配置 TextBus 默认的格式，则编辑器只会支持你自定义的格式。</p><pre lang="TypeScript"><div style="width:2em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;options = {</div><div class="tb-code-line">&nbsp;&nbsp;formatLoaders: [</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 格式列表</span></div><div class="tb-code-line">&nbsp;&nbsp;]</div><div class="tb-code-line">}</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<p>查看<a target="_self" href="/docs/formatter">格式​开发</a>文档</p>
<h3>默认内容 content</h3>
<p>在创建编辑器时，你可以设置编辑器的默认内容。内容可以为一个 HTML 字符串，或 TextBus 指定的 JSON 数据。</p><pre lang="TypeScript"><div style="width:2em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;options = {</div><div class="tb-code-line">&nbsp;&nbsp;content:&nbsp;<span class="tb-hl-string">'&lt;p&gt;你好，我是 TextBus 富文本编辑器！&lt;/p&gt;'</span></div><div class="tb-code-line">}</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<h3>样式表 styleSheets</h3>
<p>styleSheets 为一组 css 样式表，可以配置编辑器内文档的默认样式。在调用 getContents 方法时，这里的样式表会返回在结果中。</p><pre lang="TypeScript"><div style="width:2em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;options = {</div><div class="tb-code-line">&nbsp;&nbsp;styleSheets: [</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-string">'body { background: #ccc; color: #333}'</span></div><div class="tb-code-line">&nbsp;&nbsp;]</div><div class="tb-code-line">}</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<h3>编辑时样式表 editingStyleSheets</h3>
<p>editingStyleSheets 为一组 css 样式表，可以配置编辑器内文档的在编辑时的默认样式。在调用 getContents 方法时，这里的样式表不会返回在结果中。</p><pre lang="TypeScript"><div style="width:2em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;options = {</div><div class="tb-code-line">&nbsp;&nbsp;styleSheets: [</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-string">'p { font-size: 14px}'</span></div><div class="tb-code-line">&nbsp;&nbsp;]</div><div class="tb-code-line">}</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<h3>插件 plugins</h3>
<p>plugins 为一个数组，可以配置编辑器的插件。如果你有自定义的插件，你应该把你的插件和 TextBus 的插件一起放在这里。你也可以不配置 TextBus 默认的插件，则编辑器只会支持你自定义的插件。</p><pre lang="TypeScript"><div style="width:2em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;options = {</div><div class="tb-code-line">&nbsp;&nbsp;plugins: [</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 你的插件</span></div><div class="tb-code-line">&nbsp;&nbsp;]</div><div class="tb-code-line">}</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<p>查看<a target="_self" href="/docs/plugin">插件​开发</a>文档</p>
<h3>提供者 providers</h3>
<p>providers 为一个数组，专为高级开发提供的配置入口，providers 里面的类，可以使用 TextBus 内核中的依赖注入能力。方便扩展高级应用，一般使用者可以忽略。</p>
<h3>主题 theme</h3>
<p>配置主题，可以配置 TextBus 的用户界面。</p><pre lang="TypeScript"><div style="width:2em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;options = {</div><div class="tb-code-line">&nbsp;&nbsp;theme:&nbsp;<span class="tb-hl-string">'dark'</span></div><div class="tb-code-line">}</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<h3>国际化 i18n</h3>
<p>i18n 为一个 JSON 对象，可以配置 TextBus 中的文案文本。TextBus 默认为中文，同时提供了英语配置。你也可以根据自己的需要，改为其它语言。</p><pre lang="TypeScript"><div style="width:2em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ i18n_en_US }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/editor'</span></div><div class="tb-code-line"><br></div><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;options = {</div><div class="tb-code-line">&nbsp;&nbsp;i18n: i18n_en_US</div><div class="tb-code-line">}</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<h3>提示文字 placeholder</h3>
<p>配置编辑器内容为空时的提示文字。</p><pre lang="TypeScript"><div style="width:2em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;options = {</div><div class="tb-code-line">&nbsp;&nbsp;placeholder:&nbsp;<span class="tb-hl-string">'请输入内容...'</span></div><div class="tb-code-line">}</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<h3>文件上传 uploader</h3>
<p>uploader 为一个函数，TextBus 未实现任何与 ajax 相关的功能。如果你需要资源上传，则必须配置此项，当需要文件上传时，TextBus 会调用此函数，并根据返回值做相应处理。</p><pre lang="TypeScript"><div style="width:2em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;options = {</div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">uploader</span>(uploadConfig) {</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 你的上传实现</span></div><div class="tb-code-line">&nbsp;&nbsp;}</div><div class="tb-code-line">}</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<p>其中 uploadConfig 为如下结构</p><pre lang="TypeScript"><div style="width:2em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">export</span>&nbsp;<span class="tb-hl-keyword">interface</span>&nbsp;<span class="tb-hl-class-name">UploadConfig</span>&nbsp;{</div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">/** 上传类型 */</span></div><div class="tb-code-line">&nbsp;&nbsp;uploadType:&nbsp;<span class="tb-hl-builtin">string</span></div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">/** 当前值 */</span></div><div class="tb-code-line">&nbsp;&nbsp;currentValue:&nbsp;<span class="tb-hl-builtin">string</span></div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">/** 是否支持返回多个结果 */</span></div><div class="tb-code-line">&nbsp;&nbsp;multiple:&nbsp;<span class="tb-hl-builtin">boolean</span></div><div class="tb-code-line">}</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<p>如果 multiple 为&nbsp;<code>false</code>，则表示你只能返回一个 url 字符串，或返回一个&nbsp;<code>Promise&lt;string&gt;</code>，否则表示你可以返回多张图片的 url，或<br>&nbsp;&nbsp;<code>Promise&lt;string[]&gt;</code>。</p>
<p>下面以 jQuery 上传单张图片为例</p><pre lang="TypeScript"><div style="width:2em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;options = {</div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">uploader</span>(uploadConfig) {</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">switch</span>&nbsp;(uploadConfig.uploadType) {</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">case</span>&nbsp;<span class="tb-hl-string">'image'</span>:</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">var</span>&nbsp;fileInput = document.<span class="tb-hl-function">createElement</span>(<span class="tb-hl-string">'input'</span>);</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fileInput.<span class="tb-hl-function">setAttribute</span>(<span class="tb-hl-string">'type'</span>,&nbsp;<span class="tb-hl-string">'file'</span>);</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fileInput.<span class="tb-hl-function">setAttribute</span>(<span class="tb-hl-string">'accept'</span>, 'image/png, image/gif, image/jpeg,</div><div class="tb-code-line">&nbsp;&nbsp;image/bmp, image/x-icon');</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fileInput.multiple = uploadConfig.multiple</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fileInput.style.cssText = 'position: absolute; left: -9999px; top:</div><div class="tb-code-line">&nbsp;&nbsp;-9999px; opacity:&nbsp;<span class="tb-hl-number">0</span>';</div><div class="tb-code-line"><br></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">var</span>&nbsp;promise =&nbsp;<span class="tb-hl-keyword">new</span>&nbsp;<span class="tb-hl-builtin">Promise</span>(<span class="tb-hl-keyword">function</span>&nbsp;(resolve) {</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fileInput.<span class="tb-hl-function">addEventListener</span>(<span class="tb-hl-string">'change'</span>,&nbsp;<span class="tb-hl-keyword">function</span>&nbsp;(event) {</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">var</span>&nbsp;form =&nbsp;<span class="tb-hl-keyword">new</span>&nbsp;<span class="tb-hl-class-name">FormData</span>();</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">var</span>&nbsp;files = event.target.files;</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">for</span>&nbsp;(<span class="tb-hl-keyword">var</span>&nbsp;i =&nbsp;<span class="tb-hl-number">0</span>; i &lt; files.length; i++) {</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 这里的 file 字符串为后台接收 FormData的字段名，可以改成自己需要的名字</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.<span class="tb-hl-function">append</span>(<span class="tb-hl-string">'file'</span>, files[i]);</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.body.<span class="tb-hl-function">removeChild</span>(fileInput);</div><div class="tb-code-line"><br></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 下面以 jQuery 为例实现上传</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$.<span class="tb-hl-function">ajax</span>({</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type:&nbsp;<span class="tb-hl-string">"post"</span>,</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url:&nbsp;<span class="tb-hl-string">'/api/upload'</span>,</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data: form,</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataType:&nbsp;<span class="tb-hl-string">'json'</span>,</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;processData:&nbsp;<span class="tb-hl-boolean">false</span>,</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;success:&nbsp;<span class="tb-hl-keyword">function</span>&nbsp;(response) {</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">if</span>&nbsp;(response.success) {</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">resolve</span>(response.imageUrl)</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error:&nbsp;<span class="tb-hl-keyword">function</span>&nbsp;() {</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-builtin">console</span>.<span class="tb-hl-function">log</span>(<span class="tb-hl-string">'上传失败！'</span>);</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})</div><div class="tb-code-line"><br></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.body.<span class="tb-hl-function">appendChild</span>(fileInput);</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fileInput.<span class="tb-hl-function">click</span>();</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;promise;</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div class="tb-code-line">&nbsp;&nbsp;}</div><div class="tb-code-line">}</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<h2>分离工具条</h2>
<p>工具条支持自持自定义容器，你需要传入一个 css 选择器或 DOM 元素作为容器，并手动实例化工具条插件。</p><pre lang="HTML"><div style="width:2em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line">&lt;<span class="tb-hl-tag">div&nbsp;</span><span class="tb-hl-attr-name">id</span>="<span class="tb-hl-attr-value">toolbar</span>"&gt;&lt;/<span class="tb-hl-tag">div</span>&gt;</div></div><span class="tb-pre-lang">HTML</span></pre><pre lang="TypeScript"><div style="width:2em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;toolbar =&nbsp;<span class="tb-hl-keyword">new</span>&nbsp;<span class="tb-hl-class-name">Toolbar</span>(</div><div class="tb-code-line">&nbsp;&nbsp;[</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 这里是你要配置的工具</span></div><div class="tb-code-line">&nbsp;&nbsp;],</div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">// 传入工条具容器</span></div><div class="tb-code-line">&nbsp;&nbsp;document.<span class="tb-hl-function">getElementById</span>(<span class="tb-hl-string">'toolbar'</span>)</div><div class="tb-code-line">)</div><div class="tb-code-line"><br></div><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;editor =&nbsp;<span class="tb-hl-function">createEditor</span>(document.<span class="tb-hl-function">getElementById</span>(<span class="tb-hl-string">'editor'</span>), {</div><div class="tb-code-line">&nbsp;&nbsp;plugins: [</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;toolbar</div><div class="tb-code-line">&nbsp;&nbsp;]</div><div class="tb-code-line">})</div></div><span class="tb-pre-lang">TypeScript</span></pre>
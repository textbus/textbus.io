<h1>组件</h1>
<p>什么是 TextBus 的组件？</p>
<p>我们应当都使用过现代前端框架，如 React、Vue、Angular 等，如果你有使用过，那么你会在轻松的上手。如果你没用使用过前端的框架，也没关系，只要阅读下面的文档，你一样可以快速开发出来。&nbsp;</p>
<p>组件带给我们良好的封装、丰富的功能和易于维护和扩展的开发体验。使用 TextBus 开发富文本组件，也可以像前端框架一样，只需要掌握少量的 API 以及生命周期等，即可开发出令人惊叹的富文本组件。当然，TextBus 的组件也有自己的特有的功能，如自动记录操作历史，支持插槽编辑等，不过，你基本无需关心这些，因为 TextBus 的内核已经帮你做好了。</p>
<p>要创建 TextBus 的组件，只需要调用&nbsp;<code>defineComponent</code>&nbsp;函数，并编写特定的配置项即可。 一个简单的组件如下：</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ defineComponent, ContentType, useSlots, Slot }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/core'</span></span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">export</span>&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;myComponent =&nbsp;<span class="tb-hl-function">defineComponent</span>({</span><span class="tb-code-line">&nbsp;&nbsp;type: ContentType.BlockComponent,&nbsp;<span class="tb-hl-comment">// 设置组件类型</span></span><span class="tb-code-line">&nbsp;&nbsp;name:&nbsp;<span class="tb-hl-string">'MyComponent'</span>, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 组件的名字，不可重复</span></span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">transform</span>(translator, state) { &nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 将当前组件 json 数据转换为实例</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;translator.<span class="tb-hl-function">createSlot</span>(state)</span><span class="tb-code-line">&nbsp;&nbsp;},</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">setup</span>(slot) {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 组件的具体逻辑</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;slots =&nbsp;<span class="tb-hl-function">useSlots</span>(slot ||&nbsp;<span class="tb-hl-keyword">new</span>&nbsp;<span class="tb-hl-class-name">Slot</span>([</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ContentType.Text</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;]))</span><span class="tb-code-line"><br></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;{</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">render</span>(isOutputMode, slotRender) {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;(</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;my-component&gt;</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">slotRender</span>(slots.<span class="tb-hl-function">get</span>(<span class="tb-hl-number">0</span>), () =&gt; {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;&lt;p/&gt;</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/my-component&gt;</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">toJSON</span>() {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;slots.<span class="tb-hl-function">get</span>(<span class="tb-hl-number">0</span>).<span class="tb-hl-function">toJSON</span>()</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="tb-code-line">&nbsp;&nbsp;}</span><span class="tb-code-line">})</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<p>TextBus 组件支持用 jsx 或 tsx 编写，也可以用&nbsp;<code>new VElement('p')</code>&nbsp;或者&nbsp;<code>new VTextNode('text')</code>&nbsp;的方式编写。</p>
<p>上面示例是一个最简单的组件，但它基本包含了 TextBus 组件的基本形态，更复杂的组件，无非是在这个基础上增加更多的逻辑而已。</p>
<p>为了让 TextBus 能从 HTML 中识别出组件，我们还需要创建组件加载器。加载器用于从文档中识别并读取出组件的必要信息，从而生成 TextBus 的组件实例的工具类，由于 TextBus 是跨平台的，所以不同平台的加载器也可能是不同的，我们以 PC 平台为例。</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ Slot, ContentType }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/core'</span></span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">export</span>&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;myComponentLoader = {</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">// 设置组件的根元素为块级样式</span></span><span class="tb-code-line">&nbsp;&nbsp;reources: {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;styles: [<span class="tb-hl-string">'my-component{display:block}'</span>]</span><span class="tb-code-line">&nbsp;&nbsp;},</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">match</span>(element) {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 匹配一个 DOM 元素，返回 true 即表示为当前组件</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;element.tagName.<span class="tb-hl-function">toLowerCase</span>() ===&nbsp;<span class="tb-hl-string">'my-component'</span></span><span class="tb-code-line">&nbsp;&nbsp;},</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">read</span>(element, injector, slotParser) {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 读取当前 DOM 元素下组件指定的结构，并返回组件实例</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;slot =&nbsp;<span class="tb-hl-function">slotParser</span>(<span class="tb-hl-keyword">new</span>&nbsp;<span class="tb-hl-class-name">Slot</span>([</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ContentType.Text</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;]), element.children[<span class="tb-hl-number">0</span>])</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;paragraphComponent.<span class="tb-hl-function">createInstance</span>(injector, slot)</span><span class="tb-code-line">&nbsp;&nbsp;},</span><span class="tb-code-line">&nbsp;&nbsp;component: myComponent</span><span class="tb-code-line">}</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<p>现在我们在编辑器中添加我们刚创建的组件。</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ Editor }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/editor'</span></span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;editor =&nbsp;<span class="tb-hl-keyword">new</span>&nbsp;<span class="tb-hl-class-name">Editor</span>(<span class="tb-hl-string">'#editor'</span>, {</span><span class="tb-code-line">&nbsp;&nbsp;componentLoaders: [</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;myComponentLoader</span><span class="tb-code-line">&nbsp;&nbsp;]</span><span class="tb-code-line">})</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<p>我们还需要添加一个按钮，点击按钮后往文档中插入 MyComponent 组件。</p><pre lang="HTML"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line">&lt;<span class="tb-hl-tag">div&nbsp;</span><span class="tb-hl-attr-name">class</span>="<span class="tb-hl-attr-value">toolbar</span>"&gt;</span><span class="tb-code-line">&nbsp;&nbsp;&lt;<span class="tb-hl-tag">button&nbsp;</span><span class="tb-hl-attr-name">type</span>="<span class="tb-hl-attr-value">button</span>"<span class="tb-hl-tag">&nbsp;</span><span class="tb-hl-attr-name">id</span>="<span class="tb-hl-attr-value">insert-my-component</span>"&gt;插入 MyComponent&lt;/<span class="tb-hl-tag">button</span>&gt;</span><span class="tb-code-line">&lt;/<span class="tb-hl-tag">div</span>&gt;</span><span class="tb-code-line">&lt;<span class="tb-hl-tag">div&nbsp;</span><span class="tb-hl-attr-name">id</span>="<span class="tb-hl-attr-value">editor</span>"&gt;&lt;/<span class="tb-hl-tag">div</span>&gt;</span></span><span class="tb-pre-lang">HTML</span></pre><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ Commander, ContentType }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/core'</span></span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ myComponent }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'./my-component'</span></span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;insertBtn = document.<span class="tb-hl-function">getElementById</span>(<span class="tb-hl-string">'insert-my-component'</span>)</span><span class="tb-code-line"><br></span><span class="tb-code-line">editor.onReady.<span class="tb-hl-function">subscribe</span>(() =&gt; {</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;injector = editor.injector</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;commander = injector.<span class="tb-hl-function">get</span>(Commander)</span><span class="tb-code-line"><br></span><span class="tb-code-line">&nbsp;&nbsp;insertBtn.<span class="tb-hl-function">addEventListener</span>(<span class="tb-hl-string">'click'</span>, () =&gt; {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;componentInstance = myComponent.<span class="tb-hl-function">createInstance</span>()</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;commander.<span class="tb-hl-function">insert</span>(componentInstance)</span><span class="tb-code-line">&nbsp;&nbsp;})</span><span class="tb-code-line">})</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<h2>数据交互</h2>
<p>本章节主要介绍在<strong>组件 setup 函数</strong>内可以调用的一些勾子函数。</p>
<h3>useContext</h3>
<p>返回当前编辑器的注入器，通过注入器，可以获取到编辑器内部各个类的实例</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ useContext, Commander, defineComponent }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/core'</span>;</span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;myCommponent =&nbsp;<span class="tb-hl-function">defineComponent</span>({</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">setup</span>() {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 获取注入器</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;injector =&nbsp;<span class="tb-hl-function">useContext</span>()</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 获取编辑器内部类实例</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;commander = injector.<span class="tb-hl-function">get</span>(Commander)</span><span class="tb-code-line">&nbsp;&nbsp;}</span><span class="tb-code-line">})</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<h3>useSelf</h3>
<p>返回当前组件实例</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ useSelf }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/core'</span>;</span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;myCommponent =&nbsp;<span class="tb-hl-function">defineComponent</span>({</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">setup</span>() {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;componentInstance =&nbsp;<span class="tb-hl-function">useSelf</span>()</span><span class="tb-code-line">&nbsp;&nbsp;}</span><span class="tb-code-line">})</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<h3>useSlots</h3>
<p>把一组插槽挂载到文档，一个组件只允许调用一次。</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ ContentType, useSlots }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/core'</span>;</span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;myCommponent =&nbsp;<span class="tb-hl-function">defineComponent</span>({</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">setup</span>() {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;slots =&nbsp;<span class="tb-hl-function">useSlots</span>([</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">new</span>&nbsp;<span class="tb-hl-class-name">Slot</span>([</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ContentType.Text</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;])</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;], () =&gt; {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 当内容恢复时，插槽还原的工厂函数</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;<span class="tb-hl-keyword">new</span>&nbsp;<span class="tb-hl-class-name">Slot</span>([</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ContentType.Text</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;])</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;})</span><span class="tb-code-line"><br></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;{</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">render</span>(isOutputMode, slotRenderFn) {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;(</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">slotRenderFn</span>(slots.<span class="tb-hl-function">get</span>(<span class="tb-hl-number">0</span>), () =&gt; {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;&lt;p/&gt;</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="tb-code-line">&nbsp;&nbsp;}</span><span class="tb-code-line">})</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<h3>useState</h3>
<p>当前组件的自定义状态，一个组件只能调用一次。</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ useState }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/core'</span>;</span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;myCommponent =&nbsp;<span class="tb-hl-function">defineComponent</span>({</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">setup</span>() {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">let</span>&nbsp;state = {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;width:&nbsp;<span class="tb-hl-string">'100px'</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;stateController =&nbsp;<span class="tb-hl-function">useState</span>(state)</span><span class="tb-code-line"><br></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;stateController.onChange.<span class="tb-hl-function">subscribe</span>(newState =&gt; {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;state = newState</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;})</span><span class="tb-code-line"><br></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;{</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">render</span>() {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;(</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;img src=<span class="tb-hl-string">"./example.jpg"</span>&nbsp;width={state.width}/&gt;</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="tb-code-line">&nbsp;&nbsp;}</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<h3>useRef</h3>
<p>用于获取 DOM 实例</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ useRef, onViewInit }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/core'</span>;</span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;myCommponent =&nbsp;<span class="tb-hl-function">defineComponent</span>({</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">setup</span>() {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;domRef =&nbsp;<span class="tb-hl-function">useRef</span>()</span><span class="tb-code-line"><br></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">onViewInit</span>(() =&gt; {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-builtin">console</span>.<span class="tb-hl-function">log</span>(domRef.current)</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;})</span><span class="tb-code-line"><br></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;{</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">render</span>() {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;(</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p ref={domRef}&gt;我的组件&lt;/p&gt;</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="tb-code-line">&nbsp;&nbsp;}</span><span class="tb-code-line">})</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<h3>useRefs</h3>
<p>用于获取一组 DOM 实例，常用在循环中</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ useRefs, onViewInit }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/core'</span>;</span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;myCommponent =&nbsp;<span class="tb-hl-function">defineComponent</span>({</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">setup</span>() {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">const</span>&nbsp;domRefs =&nbsp;<span class="tb-hl-function">useRefs</span>()</span><span class="tb-code-line"><br></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">onViewInit</span>(() =&gt; {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-builtin">console</span>.<span class="tb-hl-function">log</span>(domRefs)</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;})</span><span class="tb-code-line"><br></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;{</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">render</span>() {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;(</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p ref={domRefs}&gt;我的组件&lt;/p&gt;</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p ref={domRefs}&gt;我的组件&lt;/p&gt;</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="tb-code-line">&nbsp;&nbsp;}</span><span class="tb-code-line">})</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<h3>useDynamicShortcut</h3>
<p>组件内部快捷键，用于只在组件内生效的快捷键</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ useDynamicShortcut }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/core'</span>;</span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;myCommponent =&nbsp;<span class="tb-hl-function">defineComponent</span>({</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">setup</span>() {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">useDynamicShortcut</span>({</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keymap: {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key:&nbsp;<span class="tb-hl-string">'Tab'</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">action</span>() {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-builtin">console</span>.<span class="tb-hl-function">log</span>(<span class="tb-hl-string">'Tab 快捷键触发了！'</span>)</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;})</span><span class="tb-code-line">&nbsp;&nbsp;}</span><span class="tb-code-line">})</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<h2>生命周期</h2>
<h3>onPaste</h3>
<p>当组件插槽发生粘贴事件时调用</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ onPaste }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/core'</span>;</span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;myCommponent =&nbsp;<span class="tb-hl-function">defineComponent</span>({</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">setup</span>() {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">onPaste</span>(ev =&gt; {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">//</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;})</span><span class="tb-code-line">&nbsp;&nbsp;}</span><span class="tb-code-line">})</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<h3>onContextMenu</h3>
<p>当用户在组件内点击鼠标右键时调用</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ onContextMenu }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/core'</span>;</span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;myCommponent =&nbsp;<span class="tb-hl-function">defineComponent</span>({</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">setup</span>() {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">onContextMenu</span>(() =&gt; {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;[{</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label:&nbsp;<span class="tb-hl-string">'自定义上下文菜单'</span>,</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">onClick</span>() {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">//</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}]</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;})</span><span class="tb-code-line">&nbsp;&nbsp;}</span><span class="tb-code-line">})</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<h3>onViewChecked</h3>
<p>当组件或子组件每次视图更新完成后调用</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ onViewChecked }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/core'</span>;</span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;myCommponent =&nbsp;<span class="tb-hl-function">defineComponent</span>({</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">setup</span>() {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">onViewChecked</span>(() =&gt; {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">//</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;})</span><span class="tb-code-line">&nbsp;&nbsp;}</span><span class="tb-code-line">})</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<h3>onViewInit</h3>
<p>当组件第一次视图渲染完成时调用</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ onViewInit }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/core'</span>;</span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;myCommponent =&nbsp;<span class="tb-hl-function">defineComponent</span>({</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">setup</span>() {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">onViewInit</span>(() =&gt; {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">//</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;})</span><span class="tb-code-line">&nbsp;&nbsp;}</span><span class="tb-code-line">})</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<h3>onSlotRemove</h3>
<p>当用户触发组件插槽删除前调用</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ onSlotRemove }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/core'</span>;</span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;myCommponent =&nbsp;<span class="tb-hl-function">defineComponent</span>({</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">setup</span>() {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">onSlotRemove</span>(ev =&gt; {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">//</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;})</span><span class="tb-code-line">&nbsp;&nbsp;}</span><span class="tb-code-line">})</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<h3>onContentDelete</h3>
<p>当用户删除组件插槽内内容时调用</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ onContentDelete }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/core'</span>;</span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;myCommponent =&nbsp;<span class="tb-hl-function">defineComponent</span>({</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">setup</span>() {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">onContentDelete</span>(ev =&gt; {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">//</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;})</span><span class="tb-code-line">&nbsp;&nbsp;}</span><span class="tb-code-line">})</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<h3>onEnter</h3>
<p>当用户在组件插槽内按回车键时调用</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ onEnter }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/core'</span>;</span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;myCommponent =&nbsp;<span class="tb-hl-function">defineComponent</span>({</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">setup</span>() {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">onEnter</span>(ev =&gt; {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">//</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;})</span><span class="tb-code-line">&nbsp;&nbsp;}</span><span class="tb-code-line">})</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<h3>onContentInsert</h3>
<p>当用户在组件插槽内输入时调用</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ onContentInsert }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/core'</span>;</span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;myCommponent =&nbsp;<span class="tb-hl-function">defineComponent</span>({</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">setup</span>() {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">onContentInsert</span>(ev =&gt; {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">//</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;})</span><span class="tb-code-line">&nbsp;&nbsp;}</span><span class="tb-code-line">})</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<h3>onContentInserted</h3>
<p>当用户在组件插槽内输入完成时调用</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ onContentInserted }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/core'</span>;</span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;myCommponent =&nbsp;<span class="tb-hl-function">defineComponent</span>({</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">setup</span>() {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">onContentInserted</span>(ev =&gt; {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">//</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;})</span><span class="tb-code-line">&nbsp;&nbsp;}</span><span class="tb-code-line">})</span></span><span class="tb-pre-lang">TypeScript</span></pre>
<h3>onDestroy</h3>
<p>当组件销毁时调用</p><pre lang="TypeScript"><span style="width:2em" class="tb-code-line-number-bg"></span><span class="tb-code-content"><span class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ onDestroy }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/core'</span>;</span><span class="tb-code-line"><br></span><span class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;myCommponent =&nbsp;<span class="tb-hl-function">defineComponent</span>({</span><span class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">setup</span>() {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">onDestroy</span>(() =&gt; {</span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">//</span></span><span class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;})</span><span class="tb-code-line">&nbsp;&nbsp;}</span><span class="tb-code-line">})</span></span><span class="tb-pre-lang">TypeScript</span></pre>
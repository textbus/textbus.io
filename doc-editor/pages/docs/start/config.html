<h1>配置</h1>
<p>通过配置，你可以定制编辑器的行为、功能、插件、格式等。自定义配置的方式如下</p><pre lang="TypeScript" theme="null" class="tb-pre"><div style="width:2.5em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ createEditor }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/editor'</span>;</div><div class="tb-code-line"><br></div><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;options = {</div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">// 这里是配置项</span></div><div class="tb-code-line">}</div><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;editor =&nbsp;<span class="tb-hl-function">createEditor</span>(options)</div><div class="tb-code-line">editor.<span class="tb-hl-function">mount</span>(document.<span class="tb-hl-function">getElementById</span>(<span class="tb-hl-string">'editor'</span>))</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<p>通过 createEditor 函数创建编辑器时，你配置的字段会覆盖默认的配置，如你配置了 placeholder，则会覆盖掉默认的 placeholder，但其它的配置项还会使用默认值。</p>
<p>通过 createEditor 函数创建编辑器且不传入参数时，会使用默认配置。默认配置有可能<strong style="color:rgb(231, 79, 94)">随着版本更新而改变</strong>，你可以参考<a target="_blank" href="https://github.com/textbus/textbus/blob/main/packages/editor/src/create-editor.ts">源代码</a>。</p>
<h2>配置项</h2>
<p style="background-color:rgb(255, 255, 255)"><span style="color:rgb(73, 80, 96)">Textbus 为分层架构设计，且上层模块在继承底层模块的配置时，也会有自己增加的配置，从底层到上层分别是：</span></p>
<p style="background-color:rgb(255, 255, 255)"><strong style="color:rgb(18, 150, 219)">Core 内核</strong><span style="color:rgb(73, 80, 96)">&nbsp;-&gt;&nbsp;</span><span style="color:rgb(18, 150, 219)"><strong>Browser 视图层</strong>&nbsp;</span><span style="color:rgb(73, 80, 96)">-&gt;&nbsp;</span><strong style="color:rgb(18, 150, 219)">编辑器层</strong></p>
<h3>内核配置</h3><pre lang="TypeScript" theme="null" class="tb-pre"><div style="width:2.5em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-comment">/**</span></div><div class="tb-code-line"><span class="tb-hl-comment">&nbsp;* Textbus 模块配置</span></div><div class="tb-code-line"><span class="tb-hl-comment">&nbsp;*/</span></div><div class="tb-code-line"><span class="tb-hl-keyword">export</span>&nbsp;<span class="tb-hl-keyword">interface</span>&nbsp;<span class="tb-hl-class-name">Module</span>&nbsp;{</div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">/** 组件列表 */</span></div><div class="tb-code-line">&nbsp;&nbsp;components?: Component[]</div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">/** 格式列表 */</span></div><div class="tb-code-line">&nbsp;&nbsp;formatters?: Formatter&lt;<span class="tb-hl-builtin">any</span>&gt;[]</div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">/** 属性列表 */</span></div><div class="tb-code-line">&nbsp;&nbsp;attributes?: Attribute&lt;<span class="tb-hl-builtin">any</span>&gt;[]</div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">/** 跨平台及基础扩展实现的提供者 */</span></div><div class="tb-code-line">&nbsp;&nbsp;providers?: Provider[]</div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">/** 插件集合 */</span></div><div class="tb-code-line">&nbsp;&nbsp;plugins?:&nbsp;<span class="tb-hl-builtin">Array</span>&lt;() =&gt; Plugin&gt;</div><div class="tb-code-line"><br></div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">/**</span></div><div class="tb-code-line"><span class="tb-hl-comment">&nbsp;&nbsp;&nbsp;* 初始化之前的设置，返回一个函数，当 Textbus 销毁时调用</span></div><div class="tb-code-line"><span class="tb-hl-comment">&nbsp;&nbsp;&nbsp;* @param starter</span></div><div class="tb-code-line"><span class="tb-hl-comment">&nbsp;&nbsp;&nbsp;*/</span></div><div class="tb-code-line">&nbsp;&nbsp;setup?(starter: Starter):&nbsp;<span class="tb-hl-builtin">Promise</span>&lt;(() =&gt;&nbsp;<span class="tb-hl-keyword">void</span>) |&nbsp;<span class="tb-hl-keyword">void</span>&gt; | (() =&gt;&nbsp;<span class="tb-hl-keyword">void</span>) |&nbsp;<span class="tb-hl-keyword">void</span></div><div class="tb-code-line">}</div><div class="tb-code-line"><br></div><div class="tb-code-line"><span class="tb-hl-comment">/**</span></div><div class="tb-code-line"><span class="tb-hl-comment">&nbsp;* Textbus 核心配置</span></div><div class="tb-code-line"><span class="tb-hl-comment">&nbsp;*/</span></div><div class="tb-code-line"><span class="tb-hl-keyword">export</span>&nbsp;<span class="tb-hl-keyword">interface</span>&nbsp;<span class="tb-hl-class-name">TextbusConfig</span>&nbsp;<span class="tb-hl-keyword">extends</span>&nbsp;<span class="tb-hl-class-name">Module</span>&nbsp;{</div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">/** 导入第三方包 */</span></div><div class="tb-code-line">&nbsp;&nbsp;imports?: Module[]</div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">/** 开启 Zen Coding 支持 */</span></div><div class="tb-code-line">&nbsp;&nbsp;zenCoding?:&nbsp;<span class="tb-hl-builtin">boolean</span></div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">/** 最大历史记录栈 */</span></div><div class="tb-code-line">&nbsp;&nbsp;historyStackSize?:&nbsp;<span class="tb-hl-builtin">number</span></div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">/** 是否只读 */</span></div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-keyword">readonly</span>?:&nbsp;<span class="tb-hl-builtin">boolean</span></div><div class="tb-code-line">}</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<h4>组件 components&nbsp;</h4>
<p>一个数组，配置当前编辑器可支持的组件。</p>
<h4>格式 formatters</h4>
<p>一个数组，配置当前编辑器可支持的格式。</p>
<h4>提供者 providers</h4>
<p>一个数组，<span style="background-color:rgb(255, 255, 255);color:rgb(73, 80, 96)">专为高级开发提供的配置入口，providers 里面的类，可以使用 Textbus 内核中的依赖注入能力。方便扩展高级应用，一般使用者可以忽略。</span></p>
<h4>插件 plugins</h4>
<p>一个数组，<span style="background-color:rgb(255, 255, 255);color:rgb(73, 80, 96)">可以配置编辑器的插件。如果你有自定义的插件，你应该把你的插件和 Textbus 的插件一起放在这里。你也可以不配置 Textbus 默认的插件，则编辑器只会支持你自定义的插件。</span></p>
<h4>编辑器预设 setup</h4>
<p style="background-color:rgb(255, 255, 255)"><span style="color:rgb(73, 80, 96)">一个函数，在编辑器启动前调用，可根据需要设置编辑器的特性。同时，可选返回一个函数，编辑器会在销毁时调用。</span></p><pre lang="TypeScript" theme="null" class="tb-pre"><div style="width:2.5em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;options = {</div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">setup</span>(injector) {</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 这里可根据 injector 获取编辑器内部实例，如：</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// const commander = injector.get(Commander)</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;() =&gt; {</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-builtin">console</span>.<span class="tb-hl-function">log</span>(<span class="tb-hl-string">'Textbus destroyed!'</span>)</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div class="tb-code-line">&nbsp;&nbsp;}</div><div class="tb-code-line">}</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<h4>导入模块 imports</h4>
<p>一个数组，用于配置第三方扩展模块。</p>
<h4>组件语法糖 zenCoding</h4>
<p>开启语法糖实时转换，如 markdown。默认为 false。当值为 true 时，Textbus 会在空白行输入时，自动检测当前输入字符是否符合组件预设语法。如果匹配上，则会自动转换为相应的组件。</p>
<p><span style="color:rgb(231, 79, 94)">注意：</span>Textbus 的 zenCoding 转换实现，需组件实现相关接口才会转换，否则会无效。具体可参考组件相关文档。</p>
<h4>最大历史记录 historyStackSize</h4>
<p>历史记录最大步数，默认为 500。</p>
<h4>只读 readonly</h4>
<p>开启只读模式，默认为 false。当值为 true 时，你将无法对文档做任何编辑。</p>
<p><span style="color:rgb(231, 79, 94)">注意：</span>只读模式只对自己生效，在协作场景中，其它用户还是可以更改文档的。</p>
<h3>视图层配置&nbsp;</h3>
<p>视图层配置继承了核心配置，并排除了组件及格式，重写了模块导入配置项。此项更改与重写，主要是为了支持视图层的组件解析支持。</p><pre lang="TypeScript" theme="null" class="tb-pre"><div style="width:2.5em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">export</span>&nbsp;<span class="tb-hl-keyword">interface</span>&nbsp;<span class="tb-hl-class-name">ViewModule</span>&nbsp;<span class="tb-hl-keyword">extends</span>&nbsp;<span class="tb-hl-class-name">Module</span>&nbsp;{</div><div class="tb-code-line">&nbsp;&nbsp;componentLoaders?: ComponentLoader[]</div><div class="tb-code-line">&nbsp;&nbsp;formatLoaders?: FormatLoader&lt;<span class="tb-hl-builtin">any</span>&gt;[]</div><div class="tb-code-line">&nbsp;&nbsp;attributeLoaders?: AttributeLoader&lt;<span class="tb-hl-builtin">any</span>&gt;[]</div><div class="tb-code-line">}</div><div class="tb-code-line"><br></div><div class="tb-code-line"><span class="tb-hl-comment">/**</span></div><div class="tb-code-line"><span class="tb-hl-comment">&nbsp;* Textbus PC 端配置接口</span></div><div class="tb-code-line"><span class="tb-hl-comment">&nbsp;*/</span></div><div class="tb-code-line"><span class="tb-hl-keyword">export</span>&nbsp;<span class="tb-hl-keyword">interface</span>&nbsp;<span class="tb-hl-class-name">ViewOptions</span>&nbsp;<span class="tb-hl-keyword">extends</span>&nbsp;<span class="tb-hl-class-name">TextbusConfig</span>&nbsp;{</div><div class="tb-code-line">&nbsp;&nbsp;imports?: ViewModule[]</div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">/** 自动获取焦点 */</span></div><div class="tb-code-line">&nbsp;&nbsp;autoFocus?:&nbsp;<span class="tb-hl-builtin">boolean</span></div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">/** 编辑区最小高度 */</span></div><div class="tb-code-line">&nbsp;&nbsp;minHeight?:&nbsp;<span class="tb-hl-builtin">string</span></div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">/** 组件加载器 */</span></div><div class="tb-code-line">&nbsp;&nbsp;componentLoaders?: ComponentLoader[]</div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">/** 格式加载器 */</span></div><div class="tb-code-line">&nbsp;&nbsp;formatLoaders?: FormatLoader&lt;<span class="tb-hl-builtin">any</span>&gt;[]</div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">/** 属性加载器 */</span></div><div class="tb-code-line">&nbsp;&nbsp;attributeLoaders?: AttributeLoader&lt;<span class="tb-hl-builtin">any</span>&gt;[]</div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">/** 默认内容 */</span></div><div class="tb-code-line">&nbsp;&nbsp;content?:&nbsp;<span class="tb-hl-builtin">string</span>&nbsp;| ComponentLiteral</div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">/** 文档默认样式表 */</span></div><div class="tb-code-line">&nbsp;&nbsp;styleSheets?:&nbsp;<span class="tb-hl-builtin">string</span>[]</div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">/** 配置文档编辑状态下用到的样式 */</span></div><div class="tb-code-line">&nbsp;&nbsp;editingStyleSheets?:&nbsp;<span class="tb-hl-builtin">string</span>[]</div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">/** 使用 contentEditable 作为编辑器控制可编辑范围 */</span></div><div class="tb-code-line">&nbsp;&nbsp;useContentEditable?:&nbsp;<span class="tb-hl-builtin">boolean</span></div><div class="tb-code-line">}</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<h4>模块导入 imports</h4>
<p>一个数组，用于导入第三方模块。</p>
<h4>自动获取焦点 autoFocus</h4>
<p>配置编辑器是否自动获取焦点，默认为 false</p>
<h4 style="background-color:rgb(255, 255, 255)"><span style="color:rgb(73, 80, 96)">输入方式 useContentEditable</span></h4>
<p style="background-color:rgb(255, 255, 255)"><span style="color:rgb(73, 80, 96)">配置编辑输入方式，默认为 false，当值为 true 时，Textbus 会启用浏览器原生的 contenteditable 模式进行编辑，此特性可用于兼容移动端。</span></p>
<h4>最小高度 minHeight</h4>
<p>编辑区最小高度，默认为 1em。</p>
<h4>组件 componentLoaders</h4>
<p>componentLoaders 为一个数组，可以配置编辑器支持的组件。Textbus 开发了常见的组件，如果你有自定义组件，你应该把你的组件和 Textbus 的组件一起放在这里。你也可以不配置 Textbus<br>默认的组件，则编辑器只会支持你自定义的组件。<br></p><pre lang="TypeScript" theme="null" class="tb-pre"><div style="width:2.5em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;options = {</div><div class="tb-code-line">&nbsp;&nbsp;componentLoaders: [</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 组件列表</span></div><div class="tb-code-line">&nbsp;&nbsp;]</div><div class="tb-code-line">}</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<h4>格式 formatLoaders</h4>
<p>formatLoaders 为一个数组，可以配置编辑器支持的格式。Textbus 已开发了常见的格式，如果你有自定义格式，你应该把你的格式和 Textbus 的格式一起放在这里。</p>
<p>你也可以不配置 Textbus 默认的格式，则编辑器只会支持你自定义的格式。</p><pre lang="TypeScript" theme="null" class="tb-pre"><div style="width:2.5em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;options = {</div><div class="tb-code-line">&nbsp;&nbsp;formatLoaders: [</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 格式列表</span></div><div class="tb-code-line">&nbsp;&nbsp;]</div><div class="tb-code-line">}</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<h4>默认内容 content</h4>
<p>在创建编辑器时，你可以设置编辑器的默认内容。内容可以为一个 HTML 字符串，或 Textbus 指定的 JSON 数据。</p><pre lang="TypeScript" theme="null" class="tb-pre"><div style="width:2.5em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;options = {</div><div class="tb-code-line">&nbsp;&nbsp;content:&nbsp;<span class="tb-hl-string">'&lt;p&gt;你好，我是 Textbus 富文本编辑器！&lt;/p&gt;'</span></div><div class="tb-code-line">}</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<h4>样式表 styleSheets</h4>
<p>styleSheets 为一组 css 样式表，可以配置编辑器内文档的默认样式。在调用 getContents 方法时，这里的样式表会返回在结果中。</p><pre lang="TypeScript" theme="null" class="tb-pre"><div style="width:2.5em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;options = {</div><div class="tb-code-line">&nbsp;&nbsp;styleSheets: [</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-string">'body { background: #ccc; color: #333}'</span></div><div class="tb-code-line">&nbsp;&nbsp;]</div><div class="tb-code-line">}</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<h4>编辑时样式表 editingStyleSheets</h4>
<p>editingStyleSheets 为一组 css 样式表，可以配置编辑器内文档的在编辑时的默认样式。在调用 getContents 方法时，这里的样式表不会返回在结果中。</p><pre lang="TypeScript" theme="null" class="tb-pre"><div style="width:2.5em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;options = {</div><div class="tb-code-line">&nbsp;&nbsp;editingStyleSheets: [</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-string">'p { font-size: 14px}'</span></div><div class="tb-code-line">&nbsp;&nbsp;]</div><div class="tb-code-line">}</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<h3>编辑器配置</h3>
<p>编辑器配置继承了视图层配置。</p><pre lang="TypeScript" theme="null" class="tb-pre"><div style="width:2.5em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">export</span>&nbsp;<span class="tb-hl-keyword">interface</span>&nbsp;<span class="tb-hl-class-name">EditorOptions</span>&nbsp;<span class="tb-hl-keyword">extends</span>&nbsp;<span class="tb-hl-class-name">ViewOptions</span>&nbsp;{</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">/** 根组件 */</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;rootComponent?: Component;</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">/** 编辑区域自动高度 */</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;autoHeight?:&nbsp;<span class="tb-hl-builtin">boolean</span>;</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">/** 主题配置，目前只支持 dark */</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;theme?:&nbsp;<span class="tb-hl-builtin">string</span>;</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">/** 自定义根组件加载器，否则使用默认根组件加载器 */</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;rootComponentLoader?: ComponentLoader;</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">/** 国际化配置 */</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;i18n?: I18NConfig;</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">/** 当内容为空时，编辑器内的提示文字 */</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;placeholder?:&nbsp;<span class="tb-hl-builtin">string</span>;</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">/**</span></div><div class="tb-code-line"><span class="tb-hl-comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* 资源上传接口</span></div><div class="tb-code-line"><span class="tb-hl-comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* @param config</span></div><div class="tb-code-line"><span class="tb-hl-comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;uploader?(config: UploadConfig):&nbsp;<span class="tb-hl-builtin">string</span>&nbsp;|&nbsp;<span class="tb-hl-builtin">string</span>[] |&nbsp;<span class="tb-hl-builtin">Promise</span>&lt;<span class="tb-hl-builtin">string</span>&nbsp;|&nbsp;<span class="tb-hl-builtin">string</span>[]&gt; | Observable&lt;<span class="tb-hl-builtin">string</span>&nbsp;|&nbsp;<span class="tb-hl-builtin">string</span>[]&gt;;</div><div class="tb-code-line">}</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<h4>根组件 rootComponent</h4>
<p>自定义根组件。</p>
<h4 style="background-color:rgb(255, 255, 255)"><span style="color:rgb(73, 80, 96)">自动高度 autoHeight</span></h4>
<p style="background-color:rgb(255, 255, 255)"><span style="color:rgb(73, 80, 96)">编辑器区高度自适应，默认为 false。当值为 true 时，编辑区的高度将随内容的高度自动增加。</span></p>
<h4>主题 theme</h4>
<p>配置主题，可以配置 Textbus 的用户界面。</p><pre lang="TypeScript" theme="null" class="tb-pre"><div style="width:2.5em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;options = {</div><div class="tb-code-line">&nbsp;&nbsp;theme:&nbsp;<span class="tb-hl-string">'dark'</span>&nbsp;<span class="tb-hl-comment">// 还可以配置 darkline、light</span></div><div class="tb-code-line">}</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<h4>根组件加载器 rootComponentLoader</h4>
<p>根组件加载器。编辑默认有实现根组件，如果你需要自定义，可以在此外覆盖。</p>
<h4>国际化 i18n</h4>
<p>i18n 为一个 JSON 对象，可以配置 Textbus 中的文案文本。Textbus 默认为中文，同时提供了英语配置。你也可以根据自己的需要，改为其它语言。</p><pre lang="TypeScript" theme="null" class="tb-pre"><div style="width:2.5em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">import</span>&nbsp;{ i18n_en_US }&nbsp;<span class="tb-hl-keyword">from</span>&nbsp;<span class="tb-hl-string">'@textbus/editor'</span></div><div class="tb-code-line"><br></div><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;options = {</div><div class="tb-code-line">&nbsp;&nbsp;i18n: i18n_en_US</div><div class="tb-code-line">}</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<h4>提示文字 placeholder</h4>
<p>配置编辑器内容为空时的提示文字。</p><pre lang="TypeScript" theme="null" class="tb-pre"><div style="width:2.5em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;options = {</div><div class="tb-code-line">&nbsp;&nbsp;placeholder:&nbsp;<span class="tb-hl-string">'请输入内容...'</span></div><div class="tb-code-line">}</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<h4>文件上传 uploader</h4>
<p>uploader 为一个函数，Textbus 未实现任何与 ajax 相关的功能。如果你需要资源上传，则必须配置此项，当需要文件上传时，Textbus 会调用此函数，并根据返回值做相应处理。</p><pre lang="TypeScript" theme="null" class="tb-pre"><div style="width:2.5em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;options = {</div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">uploader</span>(uploadConfig) {</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 你的上传实现</span></div><div class="tb-code-line">&nbsp;&nbsp;}</div><div class="tb-code-line">}</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<p>其中 uploadConfig 为如下结构</p><pre lang="TypeScript" theme="null" class="tb-pre"><div style="width:2.5em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">export</span>&nbsp;<span class="tb-hl-keyword">interface</span>&nbsp;<span class="tb-hl-class-name">UploadConfig</span>&nbsp;{</div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">/** 上传类型 */</span></div><div class="tb-code-line">&nbsp;&nbsp;uploadType:&nbsp;<span class="tb-hl-builtin">string</span></div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">/** 当前值 */</span></div><div class="tb-code-line">&nbsp;&nbsp;currentValue:&nbsp;<span class="tb-hl-builtin">string</span></div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">/** 是否支持返回多个结果 */</span></div><div class="tb-code-line">&nbsp;&nbsp;multiple:&nbsp;<span class="tb-hl-builtin">boolean</span></div><div class="tb-code-line">}</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<p>如果 multiple 为&nbsp;<code>false</code>，则表示你只能返回一个 url 字符串，或返回一个&nbsp;<code>Promise&lt;string&gt;</code>，否则表示你可以返回多张图片的 url，类型为<code>string[]</code>，或<br>&nbsp;&nbsp;<code>Promise&lt;string[]&gt;</code>。</p>
<p>下面以 jQuery 上传单张图片为例</p><pre lang="TypeScript" theme="null" class="tb-pre"><div style="width:2.5em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;options = {</div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-function">uploader</span>(uploadConfig) {</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">switch</span>&nbsp;(uploadConfig.uploadType) {</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">case</span>&nbsp;<span class="tb-hl-string">'image'</span>:</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">var</span>&nbsp;fileInput = document.<span class="tb-hl-function">createElement</span>(<span class="tb-hl-string">'input'</span>);</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fileInput.<span class="tb-hl-function">setAttribute</span>(<span class="tb-hl-string">'type'</span>,&nbsp;<span class="tb-hl-string">'file'</span>);</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fileInput.<span class="tb-hl-function">setAttribute</span>(<span class="tb-hl-string">'accept'</span>, 'image/png, image/gif, image/jpeg,</div><div class="tb-code-line">&nbsp;&nbsp;image/bmp, image/x-icon');</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fileInput.multiple = uploadConfig.multiple</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fileInput.style.cssText = 'position: absolute; left: -9999px; top:</div><div class="tb-code-line">&nbsp;&nbsp;-9999px; opacity:&nbsp;<span class="tb-hl-number">0</span>';</div><div class="tb-code-line"><br></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">var</span>&nbsp;promise =&nbsp;<span class="tb-hl-keyword">new</span>&nbsp;<span class="tb-hl-builtin">Promise</span>(<span class="tb-hl-keyword">function</span>&nbsp;(resolve) {</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fileInput.<span class="tb-hl-function">addEventListener</span>(<span class="tb-hl-string">'change'</span>,&nbsp;<span class="tb-hl-keyword">function</span>&nbsp;(event) {</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">var</span>&nbsp;form =&nbsp;<span class="tb-hl-keyword">new</span>&nbsp;<span class="tb-hl-class-name">FormData</span>();</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">var</span>&nbsp;files = event.target.files;</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">for</span>&nbsp;(<span class="tb-hl-keyword">var</span>&nbsp;i =&nbsp;<span class="tb-hl-number">0</span>; i &lt; files.length; i++) {</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 这里的 file 字符串为后台接收 FormData的字段名，可以改成自己需要的名字</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.<span class="tb-hl-function">append</span>(<span class="tb-hl-string">'file'</span>, files[i]);</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.body.<span class="tb-hl-function">removeChild</span>(fileInput);</div><div class="tb-code-line"><br></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 下面以 jQuery 为例实现上传</span></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$.<span class="tb-hl-function">ajax</span>({</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type:&nbsp;<span class="tb-hl-string">"post"</span>,</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url:&nbsp;<span class="tb-hl-string">'/api/upload'</span>,</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data: form,</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataType:&nbsp;<span class="tb-hl-string">'json'</span>,</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;processData:&nbsp;<span class="tb-hl-boolean">false</span>,</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;success:&nbsp;<span class="tb-hl-keyword">function</span>&nbsp;(response) {</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">if</span>&nbsp;(response.success) {</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-function">resolve</span>(response.imageUrl)</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error:&nbsp;<span class="tb-hl-keyword">function</span>&nbsp;() {</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-builtin">console</span>.<span class="tb-hl-function">log</span>(<span class="tb-hl-string">'上传失败！'</span>);</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})</div><div class="tb-code-line"><br></div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;document.body.<span class="tb-hl-function">appendChild</span>(fileInput);</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fileInput.<span class="tb-hl-function">click</span>();</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-keyword">return</span>&nbsp;promise;</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div class="tb-code-line">&nbsp;&nbsp;}</div><div class="tb-code-line">}</div></div><span class="tb-pre-lang">TypeScript</span></pre>
<h2>分离工具条</h2>
<p>工具条支持自持自定义容器，你需要传入一个 css 选择器或 DOM 元素作为容器，并手动实例化工具条插件。</p><pre lang="HTML" theme="null" class="tb-pre"><div style="width:2.5em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line">&lt;<span class="tb-hl-tag">div&nbsp;</span><span class="tb-hl-attr-name">id</span>="<span class="tb-hl-attr-value">toolbar</span>"&gt;&lt;/<span class="tb-hl-tag">div</span>&gt;</div></div><span class="tb-pre-lang">HTML</span></pre><pre lang="TypeScript" theme="null" class="tb-pre"><div style="width:2.5em" class="tb-code-line-number-bg"></div><div class="tb-code-content"><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;toolbar =&nbsp;<span class="tb-hl-keyword">new</span>&nbsp;<span class="tb-hl-class-name">Toolbar</span>(</div><div class="tb-code-line">&nbsp;&nbsp;[</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;<span class="tb-hl-comment">// 这里是你要配置的工具</span></div><div class="tb-code-line">&nbsp;&nbsp;],</div><div class="tb-code-line">&nbsp;&nbsp;<span class="tb-hl-comment">// 传入工条具容器</span></div><div class="tb-code-line">&nbsp;&nbsp;document.<span class="tb-hl-function">getElementById</span>(<span class="tb-hl-string">'toolbar'</span>)</div><div class="tb-code-line">)</div><div class="tb-code-line"><br></div><div class="tb-code-line"><span class="tb-hl-keyword">const</span>&nbsp;editor =&nbsp;<span class="tb-hl-function">createEditor</span>({</div><div class="tb-code-line">&nbsp;&nbsp;plugins: [</div><div class="tb-code-line">&nbsp;&nbsp;&nbsp;&nbsp;toolbar</div><div class="tb-code-line">&nbsp;&nbsp;]</div><div class="tb-code-line">})</div><div class="tb-code-line">editor.<span class="tb-hl-function">mount</span>(document.<span class="tb-hl-function">getElementById</span>(<span class="tb-hl-string">'editor'</span>))</div></div><span class="tb-pre-lang">TypeScript</span></pre>